# 종합 연구 리포트: 학원 맞춤형 수학 문제은행 시스템 구축 전략

**작성일**: 2025-12-02
**목적**: Gemini 리포트 분석 + 자체 개발 경험을 종합한 시스템 재설계 방향 수립

---

## 1. 개요

이 리포트는 5개의 Gemini 분석 리포트와 우리 프로젝트의 개발 경험(PDF 라벨링, HML 파서, HWPX 파서)을 종합하여, **학원 맞춤형 수학 문제은행 시스템**의 최적 설계 방향을 제시합니다.

### 1.1 분석한 Gemini 리포트 목록

| # | 리포트명 | 핵심 내용 |
|---|---------|----------|
| 1 | 수학비서, 매쓰플랫 UI/UX 분석 | 폐쇄형 vs 개방형 플랫폼 전략 비교 |
| 2 | 토스 UX/UI 편의성 분석 가이드 | Simplicity 철학, UX 라이팅 원칙 |
| 3 | 학원 맞춤형 수학 학습지 웹앱 기획 | Teacher's Flow 서비스 기획안 |
| 4 | UI/UX 언어 활용법 상세 안내 | 기술 구현 가이드 (Claude Code 활용) |
| 5 | 문제은행 DB 구축 시스템 제안 | 자동화 아키텍처 설계 |

### 1.2 우리 프로젝트 개발 경험

| 모듈 | 성과 | 핵심 노하우 |
|------|------|-------------|
| **PDF 라벨링** | DensityAnalyzer 기반 블록 검출 | Progressive Processing, 메모리 최적화 |
| **HML 파서** | ENDNOTE 기반 수식 추출 | HWPML 구조 파악, 이미지 처리 |
| **HWPX 파서** | ZIP 기반 간소화 파싱 | 표 구조 분석, 다중 셀 병합 처리 |

---

## 2. Gemini 리포트 핵심 분석

### 2.1 경쟁 플랫폼 분석: 매쓰플랫 vs 수학비서

#### 2.1.1 매쓰플랫 (Mathflat) - 폐쇄형 생태계

**핵심 전략**: 태블릿 퍼스트(Tablet-First), 올인원(All-in-One) 관리 도구

**UX 특징**:
- 상황 인식(Situational Awareness) 대시보드
- 위지윅(WYSIWYG) 기반 학습지 제작
- 8가지 색상 테마, 다양한 그리드 레이아웃
- 스플릿 뷰(Split View)를 통한 취약 유형 분석
- 마법사(Wizard) 패턴의 리포트 생성

**강점**:
- 즉시 사용 가능한 템플릿
- 학부모 리포팅 자동화
- 일관된 브랜드 경험

**약점**:
- 제한적인 커스터마이징
- 플랫폼 종속성

#### 2.1.2 수학비서 (Math Secretary) - 개방형 플랫폼

**핵심 전략**: 콘텐츠 중심, HWP 호환성 강조

**UX 특징**:
- 검색 엔진 패러다임
- 10단계 초정밀 난이도 필터
- 투명한 출처 표시 (기출문제 권위)
- HWP 파일 다운로드 및 편집 권한
- 프로슈머(Prosumer) 수익 모델 (매출 10% 지급)

**강점**:
- 무제한 편집 자유도
- 데이터 주권 보장
- 교사 참여형 생태계

**약점**:
- 높은 진입 장벽
- 한글 편집 능력 필요

#### 2.1.3 우리 시스템의 포지셔닝

```
     [운영 효율성]                    [콘텐츠 전문성]
          │                               │
    매쓰플랫 ●────────────────────────────● 수학비서
                        │
                   ▼ Teacher's Flow ▼
                   (우리의 목표 위치)
```

**목표**: 매쓰플랫의 직관성 + 수학비서의 자유도를 결합한 하이브리드 시스템

---

### 2.2 토스(Toss) UX 철학: Simplicity

#### 2.2.1 핵심 원칙

| 원칙 | 기존 금융 앱 | 토스 접근 | 에듀테크 적용 |
|------|-------------|----------|---------------|
| **문제 정의** | 규제 준수, 기능 구현 | 사용자 문제 해결 | 교사의 시간 절약 |
| **시각적 복잡도** | 모든 정보 나열 | 핵심만 + 점진적 공개 | 문제와 태그만 노출 |
| **역할 정의** | 화면 꾸미기 | 문제 해결 도구 | 워크플로우 최적화 |

#### 2.2.2 UX 라이팅 8원칙

1. **대답하기 쉽게 질문하기**: "서류가 있나요?" (사실 확인형)
2. **능동문 사용하기**: "돈을 보냈어요" (주체적 표현)
3. **선제적 맥락 제공**: 왜 이 질문이 필요한지 설명
4. **축하와 보상**: 성취감 있는 피드백
5. **에러의 인간화**: 대화체 오류 메시지 + 다음 행동 제시

**적용 예시**:
```
❌ "문제 등록이 완료되었습니다"
✅ "이차함수 문제 1개를 쏙 넣었어요!"

❌ "Error 503: Database connection failed"
✅ "정보를 불러오지 못했어요. 잠시 후 다시 시도해볼까요?"
```

#### 2.2.3 보안 UX의 역설: 지능형 마찰

- 일반적인 경로: **마찰 제거** (간편 인증, PIN)
- 위험 상황: **의도적 마찰 삽입** (사기 의심 계좌 경고)

**적용**: 중복 문제 등록 시 경고 모달, 난이도 불균형 시 알림

---

### 2.3 Teacher's Flow 기획안 분석

#### 2.3.1 핵심 UX 시나리오

```
Step 1: 의도 파악 (Intent)
       "어떤 수업을 준비하시나요?"
       → 담당 학급 버튼 (맥락 인식: 오늘 수업 우선)

Step 2: 문제 선택 (Selection)
       → 피드(Feed)형 인터페이스
       → 쇼핑카트 메타포 ("담기")
       → 쌍둥이 문제 스와이프 교체

Step 3: 편집 (Editing)
       → 블록 기반 드래그 앤 드롭
       → 자동 레이아웃 (Auto-Flow)
       → 2단/3단 편집 버튼

Step 4: 발행 (Publishing)
       → 모바일 to 프린터 워크플로우
       → 보안 인쇄 (QR 스캔)
       → 히스토리 자동 저장
```

#### 2.3.2 핵심 기능 명세

**1. 학원 자체 DB 자산화 (The Archive)**
- AI 기반 자동 태깅 (단원, 난이도)
- 유사성 벡터 임베딩 (쌍둥이 문제 검색)
- DAM(Digital Asset Management) UI (갤러리 뷰)

**2. 개인화된 워크스페이스 (The Dashboard)**
- 타임라인 카드 (오늘 할 일 추천)
- 최근 작업 연속성
- 인사이트 위젯 (성취도 변화)

---

### 2.4 기술 아키텍처 분석

#### 2.4.1 권장 기술 스택

| 영역 | 기술 | 선정 이유 |
|------|------|-----------|
| **Frontend** | Next.js 15 + Tailwind CSS | 서버 컴포넌트, 빠른 초기 로딩 |
| **Backend** | FastAPI (현재) / Supabase | 벡터 검색, Edge Functions |
| **OCR** | Mathpix API | 수식 인식 최고 정확도, 한글 지원 |
| **LLM** | Claude 3.5 Sonnet | 한국어 수학 커리큘럼 이해 |
| **Vector DB** | pgvector | 하이브리드 검색 지원 |

#### 2.4.2 자동화 파이프라인

```
┌─────────────────────────────────────────────────────────────┐
│                    입력 레이어 (Ingestion)                   │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐                  │
│  │   PDF   │    │   HML   │    │  HWPX   │                  │
│  └────┬────┘    └────┬────┘    └────┬────┘                  │
│       │              │              │                       │
│       └──────────────┼──────────────┘                       │
│                      ▼                                      │
└─────────────────────────────────────────────────────────────┘
                       │
┌─────────────────────────────────────────────────────────────┐
│               지능형 처리 레이어 (Intelligence)              │
│                      ▼                                      │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Segmentation: 문항 자동 분할 (Line Data 기반)        │   │
│  └────────────────────────┬─────────────────────────────┘   │
│                           ▼                                 │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Vectorization: 텍스트 임베딩 (1536차원)             │   │
│  └────────────────────────┬─────────────────────────────┘   │
│                           ▼                                 │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Auto-Tagging: LLM 기반 단원 분류 + 난이도 예측      │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                       │
┌─────────────────────────────────────────────────────────────┐
│               검수 및 저장 레이어 (Review & Storage)         │
│                      ▼                                      │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Review UI: 피드형 인터페이스 + 키보드 단축키         │   │
│  │  - Enter: 승인 → 다음                                │   │
│  │  - E: 수식 편집                                      │   │
│  │  - T: 태그 수정                                      │   │
│  └────────────────────────┬─────────────────────────────┘   │
│                           ▼                                 │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Storage: PostgreSQL + pgvector (HNSW 인덱스)        │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 우리의 개발 경험 분석

### 3.1 PDF 라벨링 시스템

#### 3.1.1 성과

- **DensityAnalyzer**: 픽셀 밀도 기반 블록 검출
- **Progressive Processing**: 대용량 PDF 처리 최적화
- **블록 그룹핑 UI**: 드래그 앤 드롭 기반 문제 그룹화

#### 3.1.2 핵심 노하우

```python
# 1. 메모리 최적화: 페이지 단위 처리
def process_page(page_index: int) -> List[Block]:
    """한 페이지만 메모리에 로드하여 처리"""

# 2. Progressive Processing: 단계별 처리
#    Upload → Page Images → Block Detection → User Grouping → Export

# 3. 블록 병합 로직
def merge_blocks(blocks: List[Block], threshold: float) -> List[Block]:
    """인접 블록 자동 병합 (threshold 기반)"""
```

#### 3.1.3 Gemini 리포트 제안과의 비교

| 우리 구현 | Gemini 제안 | 개선 방향 |
|----------|-------------|-----------|
| 픽셀 밀도 기반 | Line Data 기반 (Mathpix) | 하이브리드 적용 가능 |
| 수동 그룹핑 | 문제 번호 자동 인식 | AI 사전 그룹핑 + 수동 보정 |
| 단일 내보내기 | 히스토리 + 재생성 | 버전 관리 추가 |

---

### 3.2 HML 파서

#### 3.2.1 성과

- **ENDNOTE 기반 수식 추출**: HWPML 5.1 구조 완전 파악
- **이미지 처리**: base64 및 BinData 추출
- **표 구조 분석**: 셀 병합 포함

#### 3.2.2 핵심 노하우

```python
# HML 핵심 구조
# HWPML (root)
#   └── HEAD (문서 정보)
#   └── BODY
#         └── SECTION
#               └── P (paragraph)
#                     └── TEXT (일반 텍스트)
#                     └── EQUATION (수식)
#                           └── SCRIPT (LaTeX-like)
#                     └── PICTURE (이미지)

# ENDNOTE 기반 수식 추출의 핵심
def extract_equation(p_element):
    """ENDNOTE 태그 내의 EQUATION 추출"""
    # 1. ENDNOTE 찾기
    # 2. EQUATION/SCRIPT 추출
    # 3. 특수 문자 변환 (&#x2192; → \rightarrow)
```

#### 3.2.3 통합 방향

- HML 파서를 입력 레이어에 통합
- 추출된 수식을 LaTeX 정규화 파이프라인으로 전달
- 벡터 임베딩 생성

---

### 3.3 HWPX 파서

#### 3.3.1 성과

- **ZIP 기반 간소화 파싱**: 압축 해제 → XML 파싱
- **표 구조 완전 지원**: MERGETYPE 처리
- **이미지 추출**: BinData 디렉토리 참조

#### 3.3.2 핵심 노하우

```python
# HWPX 구조
# document.hwpx (ZIP)
#   ├── Contents/
#   │     └── section0.xml (본문)
#   ├── BinData/
#   │     └── image1.png
#   └── META-INF/
#         └── manifest.xml

# 표 셀 병합 처리
def handle_merged_cells(cell_element):
    """MERGETYPE 속성 기반 셀 병합"""
    # rowSpan: ColSpan + RowMerge 조합
    # colSpan: ColSpan 속성
```

#### 3.3.3 통합 방향

- HWPX 파서를 HML 파서와 통합 인터페이스로 제공
- 공통 출력 포맷 (Problem 객체) 정의
- 통일된 LaTeX 변환 파이프라인

---

## 4. 시스템 재설계 방향

### 4.1 아키텍처 원칙

#### 4.1.1 토스 Simplicity 적용

```
┌──────────────────────────────────────────────────────────┐
│  원칙 1: 기본값의 자동화 (Automation by Default)          │
│  - 모든 필드는 AI가 사전 입력                            │
│  - 사용자는 승인/수정만 수행                             │
├──────────────────────────────────────────────────────────┤
│  원칙 2: 시각적 단순화 (Visual Simplicity)               │
│  - 화면에는 문제 이미지 + AI 태그만 표시                 │
│  - 메타데이터는 Progressive Disclosure                  │
├──────────────────────────────────────────────────────────┤
│  원칙 3: 속도감 (Velocity)                               │
│  - Optimistic UI: 버튼 클릭 즉시 다음 화면               │
│  - 서버 응답 대기 없음                                   │
└──────────────────────────────────────────────────────────┘
```

#### 4.1.2 기술 스택 확정

**유지할 것**:
- FastAPI (Python): HML/HWPX 파서 호환성
- React + TypeScript: 프론트엔드
- TanStack Query: 서버 상태 관리

**추가할 것**:
- Tailwind CSS v4: 토스 스타일 구현
- Framer Motion: 물리 기반 애니메이션
- pgvector: 벡터 검색 (SQLite → PostgreSQL 전환 고려)

**제거할 것**:
- 불필요한 기능들 (UI/UX만 수정, 나머지는 제로베이스)

---

### 4.2 핵심 기능 재정의

#### 4.2.1 보존할 핵심 기능

| 기능 | 현재 상태 | 개선 방향 |
|------|----------|-----------|
| **PDF 라벨링** | ✅ 완성 | 토스 스타일 UI 적용 |
| **HML 파서** | ✅ 완성 | 자동 태깅 연동 |
| **HWPX 파서** | ✅ 완성 | 자동 태깅 연동 |

#### 4.2.2 신규 구현 필요

| 기능 | 우선순위 | 설명 |
|------|---------|------|
| **피드형 검수 UI** | P0 | 키보드 중심 워크플로우 |
| **자동 태깅 엔진** | P0 | LLM 기반 단원/난이도 분류 |
| **수학비서 분류 체계 연동** | P1 | 5단계 분류 트리 활용 |
| **벡터 검색** | P1 | 중복 탐지 + 유사 문제 추천 |
| **학습지 빌더** | P2 | 드래그 앤 드롭 조합 |

---

### 4.3 UI/UX 재설계 가이드라인

#### 4.3.1 디자인 토큰

```css
/* 컬러 시스템 */
:root {
  --toss-blue: 216 100% 50%;    /* 신뢰, CTA 버튼 */
  --grey-50: 210 20% 98%;       /* 배경 */
  --grey-100: 210 20% 96%;      /* 카드 배경 */
  --grey-500: 210 10% 56%;      /* 부가 텍스트 */
  --grey-700: 210 12% 30%;      /* 본문 */
  --grey-900: 210 14% 11%;      /* 제목 */
}

/* 타이포그래피 */
--font-family: 'Pretendard', sans-serif;
--font-headline: bold 24px/32px var(--font-family);
--font-body: 400 16px/24px var(--font-family);
--font-caption: 400 14px/20px var(--font-family);

/* 여백 */
--spacing-unit: 4px;
--spacing-sm: calc(var(--spacing-unit) * 2);   /* 8px */
--spacing-md: calc(var(--spacing-unit) * 4);   /* 16px */
--spacing-lg: calc(var(--spacing-unit) * 6);   /* 24px */

/* 모서리 */
--radius-sm: 8px;
--radius-md: 16px;
--radius-lg: 24px;
```

#### 4.3.2 컴포넌트 가이드라인

**버튼**:
- Primary: `bg-toss-blue text-white rounded-lg`
- 클릭 시: `scale(0.96)` + spring animation
- 햅틱 피드백 (모바일)

**카드**:
- `bg-white rounded-2xl shadow-sm p-4`
- 호버 시: `shadow-md` 전환
- 클릭 시: `scale(0.98)`

**입력 필드**:
- 플레이스홀더: 구체적인 예시 ("예: 이차함수")
- 자동완성 드롭다운
- 실시간 검증 피드백

---

## 5. 실행 계획

### 5.1 Phase 21: UI/UX 리디자인

**목표**: 토스 스타일 UI 시스템 구축

**작업 항목**:
1. Tailwind CSS v4 설정 + 디자인 토큰
2. 공통 컴포넌트 라이브러리 (Button, Card, Input)
3. 애니메이션 시스템 (Framer Motion)
4. 다크 모드 지원 (선택)

### 5.2 Phase 22: 피드형 검수 UI

**목표**: 키보드 중심 고속 검수 워크플로우

**작업 항목**:
1. 피드 레이아웃 구현
2. 키보드 단축키 시스템
3. Optimistic UI 업데이트
4. 토스트 알림 시스템

### 5.3 Phase 23: 자동 태깅 엔진

**목표**: AI 기반 사전 분류

**작업 항목**:
1. 수학비서 분류 체계 연동
2. LLM 프롬프트 설계 (단원/난이도)
3. LaTeX 정규화 파이프라인
4. 자동 태깅 API

### 5.4 Phase 24: 벡터 검색

**목표**: 중복 탐지 + 유사 문제 추천

**작업 항목**:
1. 임베딩 모델 선정 (OpenAI text-embedding-3-small)
2. pgvector 설정
3. 하이브리드 검색 구현
4. 중복 경고 UI

---

## 6. 결론

### 6.1 핵심 인사이트

1. **UX가 기술을 이긴다**: 토스의 성공은 기술력이 아닌 사용자 경험 혁신에서 왔다
2. **자동화 + 검수**: 100% 자동화가 아닌, AI 사전 처리 + 인간 승인 모델이 최적
3. **속도가 경쟁력**: Optimistic UI, 키보드 단축키로 작업 속도 극대화

### 6.2 다음 단계

1. **즉시**: PDF 라벨링, HML, HWPX 외 기능 정리 (제로베이스)
2. **1주차**: 토스 스타일 디자인 시스템 구축
3. **2주차**: 피드형 검수 UI 구현
4. **3주차**: 자동 태깅 + 벡터 검색 통합

---

## 부록 A: 참고 자료

### Gemini 리포트 목록

1. `1.수학비서, 매쓰플랫 UI_UX 분석.md`
2. `2.토스 UX_UI 편의성 분석 가이드.md`
3. `3.학원 맞춤형 수학 학습지 웹앱 기획.md`
4. `4.UI_UX 언어 활용법 상세 안내.md`
5. `5.문제은행 DB 구축 시스템 제안.md`

### 프로젝트 핵심 파일

- `backend/app/services/hangul/hml_parser.py`: HML 파서
- `backend/app/services/hangul/hwpx_parser.py`: HWPX 파서
- `src/density_analyzer.py`: PDF 블록 검출
- `backend/app/data/classification/math_tree.json`: 수학비서 분류 체계

---

*최종 업데이트: 2025-12-02*
