# 통합 문제은행 삭제 UI/UX 연구 리포트

**작성일**: 2025-11-28
**Phase**: 18 (예정)
**작성자**: Claude Code (Opus)
**상태**: 연구 완료, 구현 대기

---

## 1. 현황 분석

### 1.1 현재 시스템 상태

| 구분 | 상태 | 비고 |
|------|------|------|
| 삭제 API | ❌ 미구현 | DELETE 엔드포인트 없음 |
| 삭제 UI | ❌ 미구현 | 버튼/액션 없음 |
| 선택 기능 | ❌ 미구현 | 다중 선택 불가 |
| 실행 취소 | ❌ 미구현 | Undo 기능 없음 |

### 1.2 현재 UI 구조

```
IntegratedProblemBankPage
├── 통계 카드 (4개)
├── 필터 섹션 (검색, 과목, 학년 등)
├── 문제 그리드 (ProblemCard * N)
│   └── 클릭 → 상세 모달
└── 페이지네이션
```

### 1.3 데이터 구조

```
dataset_root/problem_bank/
├── index.json           # 문제 인덱스 (삭제 시 업데이트 필요)
├── problems/
│   └── {uuid}.json      # 문제 파일
├── answers/
│   └── {uuid}.json      # 정답 파일 (연관 삭제 필요)
└── explanations/
    └── {uuid}.json      # 해설 파일 (연관 삭제 필요)
```

---

## 2. 사용자 시나리오 분석

### 2.1 삭제가 필요한 상황

| 시나리오 | 빈도 | 긴급도 | 설명 |
|----------|------|--------|------|
| **파싱 오류 정정** | 높음 | 높음 | 잘못 파싱된 문제 삭제 후 재업로드 |
| **중복 제거** | 중간 | 중간 | 동일 파일 중복 업로드 |
| **오래된 데이터 정리** | 낮음 | 낮음 | 사용하지 않는 과거 문제 정리 |
| **테스트 데이터 삭제** | 높음 | 높음 | 개발/테스트 중 생성된 데이터 |
| **일괄 재파싱** | 높음 | 높음 | 파서 업데이트 후 전체 재처리 |

### 2.2 삭제 유형별 요구사항

#### 유형 A: 단일 문제 삭제
- **사용 빈도**: 중간
- **위험도**: 낮음
- **요구 기능**: 빠른 삭제, 확인 다이얼로그

#### 유형 B: 다중 문제 선택 삭제
- **사용 빈도**: 높음
- **위험도**: 중간
- **요구 기능**: 체크박스, 전체 선택, 범위 선택

#### 유형 C: 필터 기반 일괄 삭제
- **사용 빈도**: 중간
- **위험도**: 높음
- **요구 기능**: 현재 필터 조건에 맞는 모든 문제 삭제

#### 유형 D: 전체 삭제 (초기화)
- **사용 빈도**: 낮음
- **위험도**: 매우 높음
- **요구 기능**: 다중 확인, 타이핑 확인

---

## 3. UX 패턴 연구

### 3.1 업계 표준 삭제 패턴 분석

#### 3.1.1 Gmail 스타일 (권장 ⭐⭐⭐⭐⭐)

```
┌─────────────────────────────────────────────────────────┐
│ [☐] 전체 선택  │  🗑️ 삭제  │  📁 이동  │  ...더보기    │
├─────────────────────────────────────────────────────────┤
│ [☐] 문제 #1 - 다항식의 연산...                          │
│ [☐] 문제 #2 - 지수 함수의 성질...                       │
│ [☑] 문제 #3 - 로그 함수...          ← 선택됨           │
│ [☑] 문제 #4 - 삼각함수...           ← 선택됨           │
└─────────────────────────────────────────────────────────┘
                    ↓ 삭제 클릭 후
┌─────────────────────────────────────────────────────────┐
│ ✓ 2개 문제가 삭제되었습니다.              [실행 취소]   │
└─────────────────────────────────────────────────────────┘
```

**장점**:
- 직관적인 다중 선택
- 빠른 실행 취소 (Toast + Undo)
- 익숙한 패턴

**구현 요소**:
- 카드 좌상단 체크박스
- 플로팅 액션 바 (선택 시 나타남)
- Undo Toast 알림

#### 3.1.2 Notion 스타일 (권장 ⭐⭐⭐⭐)

```
┌──────────────────────────────────────┐
│ 문제 #1 - 다항식의 연산              │
│                                      │
│                      [⋮] ← 호버 시   │
└──────────────────────────────────────┘
                    ↓ 메뉴 클릭
                    ┌─────────────┐
                    │ 📋 복사      │
                    │ 📝 편집      │
                    │ ────────── │
                    │ 🗑️ 삭제      │
                    └─────────────┘
```

**장점**:
- 깔끔한 UI (호버 전에는 숨김)
- 컨텍스트 메뉴로 다양한 액션 제공
- 우클릭 메뉴 지원 가능

**구현 요소**:
- 카드 우상단 더보기 버튼 (호버 시)
- 드롭다운 메뉴
- 우클릭 컨텍스트 메뉴

#### 3.1.3 iOS 스와이프 스타일

```
     ← 스와이프
┌──────────────────────────────────────┐     ┌─────────┐
│ 문제 #1 - 다항식의 연산              │ ←── │  삭제   │
└──────────────────────────────────────┘     └─────────┘
```

**장점**:
- 모바일 친화적
- 빠른 단일 삭제

**단점**:
- 데스크톱에서 어색
- 다중 삭제 불편
- **권장하지 않음** (학원 사용 환경 = 주로 데스크톱)

#### 3.1.4 Figma 스타일

```
선택 후 Delete 키 또는 Backspace
+ Shift+클릭으로 범위 선택
+ Cmd/Ctrl+클릭으로 개별 추가 선택
```

**장점**:
- 키보드 파워유저에게 빠름
- 범위 선택 편리

**구현 요소**:
- 클릭으로 선택
- 키보드 단축키
- 시각적 선택 표시

### 3.2 권장 패턴: 하이브리드 접근

**Gmail + Notion + Figma 조합**을 권장합니다:

| 기능 | 패턴 | 설명 |
|------|------|------|
| 단일 삭제 | Notion | 카드 메뉴에서 삭제 |
| 다중 선택 | Gmail | 체크박스 + 플로팅 바 |
| 빠른 선택 | Figma | Shift+클릭 범위 선택 |
| 실행 취소 | Gmail | Toast + Undo 버튼 |

---

## 4. 안전장치 설계

### 4.1 삭제 확인 레벨

| 삭제 유형 | 확인 레벨 | UI |
|-----------|-----------|-----|
| 단일 문제 | Level 1 | Toast + Undo (5초) |
| 2-10개 문제 | Level 2 | 확인 다이얼로그 |
| 11-50개 문제 | Level 3 | 경고 + 확인 입력 |
| 50개+ 문제 | Level 4 | "삭제" 타이핑 확인 |
| 전체 삭제 | Level 5 | "전체삭제" 타이핑 + 2단계 확인 |

### 4.2 확인 다이얼로그 설계

#### Level 2: 기본 확인

```
┌──────────────────────────────────────────────────┐
│  ⚠️  문제 삭제                                    │
├──────────────────────────────────────────────────┤
│                                                  │
│  선택한 5개의 문제를 삭제하시겠습니까?           │
│                                                  │
│  • 문제 #1-1 (수학1, 지수)                       │
│  • 문제 #1-2 (수학1, 지수)                       │
│  • 문제 #1-3 (수학1, 지수)                       │
│  • ... 외 2개                                    │
│                                                  │
│  ⚠️ 이 작업은 되돌릴 수 없습니다.                │
│                                                  │
├──────────────────────────────────────────────────┤
│             [취소]              [🗑️ 삭제]        │
└──────────────────────────────────────────────────┘
```

#### Level 4: 타이핑 확인

```
┌──────────────────────────────────────────────────┐
│  🚨  대량 삭제 경고                              │
├──────────────────────────────────────────────────┤
│                                                  │
│  125개의 문제를 삭제하려고 합니다.               │
│                                                  │
│  이 작업은 되돌릴 수 없습니다.                   │
│  계속하려면 아래에 "삭제"를 입력하세요.          │
│                                                  │
│  ┌────────────────────────────────────┐         │
│  │ 삭제                               │         │
│  └────────────────────────────────────┘         │
│                                                  │
├──────────────────────────────────────────────────┤
│             [취소]              [영구 삭제]      │
└──────────────────────────────────────────────────┘
```

### 4.3 Soft Delete vs Hard Delete

| 방식 | 장점 | 단점 | 권장 |
|------|------|------|------|
| **Soft Delete** | 복구 가능, 안전 | 스토리지 사용, 복잡성 | ⭐ 권장 |
| **Hard Delete** | 즉시 정리, 단순 | 복구 불가 | 초기 구현용 |

**권장 구현 순서**:
1. Phase 18-A: Hard Delete + Undo (Toast 5초 내)
2. Phase 18-B: Soft Delete (휴지통) + 30일 자동 삭제

---

## 5. UI 컴포넌트 설계

### 5.1 선택 모드 UI

#### 5.1.1 문제 카드 (선택 가능)

```tsx
// 현재 상태
<ProblemCard onClick={handleClick} />

// 개선된 상태
<ProblemCard
  onClick={handleClick}
  selectable={isSelectionMode}
  selected={selectedIds.includes(id)}
  onSelect={handleSelect}
  onContextMenu={handleContextMenu}
/>
```

**시각적 상태**:
```
[일반]           [호버]           [선택됨]
┌──────────┐     ┌──────────┐     ┌──────────┐
│          │     │ [☐]      │     │ [☑]      │
│  #1      │     │  #1      │     │  #1      │
│  내용... │     │  내용... │     │  내용... │
│          │     │     [⋮]  │     │          │
└──────────┘     └──────────┘     └──────────┘
 border-gray     border-blue      border-blue
                                  bg-blue-50
```

#### 5.1.2 플로팅 액션 바

```
선택된 항목이 있을 때 화면 하단에 표시:

┌─────────────────────────────────────────────────────────────┐
│  ☑ 5개 선택됨     [전체 선택]  [선택 해제]      [🗑️ 삭제]  │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 컨텍스트 메뉴

```tsx
interface ContextMenuProps {
  problem: ProblemDetail;
  onView: () => void;
  onEdit: () => void;
  onDelete: () => void;
  onDuplicate: () => void;
}
```

**메뉴 항목**:
```
┌─────────────────────┐
│ 👁️  상세 보기       │
│ 📝  편집            │
│ 📋  복제            │
│ ──────────────────  │
│ 🗑️  삭제            │
└─────────────────────┘
```

### 5.3 삭제 확인 다이얼로그

```tsx
interface DeleteConfirmDialogProps {
  isOpen: boolean;
  problemCount: number;
  problems: ProblemDetail[];  // 미리보기용
  onConfirm: () => void;
  onCancel: () => void;
  level: 1 | 2 | 3 | 4 | 5;
}
```

### 5.4 Toast 알림 (Undo 지원)

```tsx
interface DeleteToastProps {
  count: number;
  onUndo: () => void;
  duration: number;  // 5000ms 기본
}

// 사용 예시
showToast({
  type: 'success',
  message: `${count}개 문제가 삭제되었습니다.`,
  action: {
    label: '실행 취소',
    onClick: handleUndo
  },
  duration: 5000
});
```

---

## 6. 백엔드 API 설계

### 6.1 필요한 엔드포인트

| 엔드포인트 | 메소드 | 설명 |
|------------|--------|------|
| `/api/hangul/problems/{id}` | DELETE | 단일 삭제 |
| `/api/hangul/problems/bulk-delete` | POST | 다중 삭제 |
| `/api/hangul/problems/delete-by-filter` | POST | 필터 기반 삭제 |
| `/api/hangul/problems/delete-all` | DELETE | 전체 삭제 |

### 6.2 API 스펙

#### 단일 삭제
```http
DELETE /api/hangul/problems/{problem_id}

Response 200:
{
  "success": true,
  "deleted_id": "uuid",
  "message": "문제가 삭제되었습니다."
}
```

#### 다중 삭제
```http
POST /api/hangul/problems/bulk-delete
Content-Type: application/json

{
  "problem_ids": ["uuid1", "uuid2", "uuid3"]
}

Response 200:
{
  "success": true,
  "deleted_count": 3,
  "deleted_ids": ["uuid1", "uuid2", "uuid3"],
  "message": "3개 문제가 삭제되었습니다."
}
```

#### 필터 기반 삭제
```http
POST /api/hangul/problems/delete-by-filter
Content-Type: application/json

{
  "subject": "수학1",
  "grade": "고2",
  "source": "라이트SSEN"
}

Response 200:
{
  "success": true,
  "deleted_count": 125,
  "message": "125개 문제가 삭제되었습니다."
}
```

### 6.3 삭제 로직

```python
async def delete_problem(problem_id: str):
    """
    문제 삭제 (연관 데이터 포함)

    1. 문제 파일 삭제: problems/{id}.json
    2. 정답 파일 삭제: answers/{answer_id}.json (있으면)
    3. 해설 파일 삭제: explanations/{explanation_id}.json (있으면)
    4. 인덱스에서 제거: index.json
    """
```

---

## 7. 구현 계획

### 7.1 Phase 18 세부 단계

| 단계 | 내용 | 예상 작업량 |
|------|------|------------|
| 18-A | DELETE API 구현 (단일/다중) | 중 |
| 18-B | 선택 모드 UI 구현 | 중 |
| 18-C | 플로팅 액션 바 | 소 |
| 18-D | 삭제 확인 다이얼로그 | 소 |
| 18-E | Toast + Undo 구현 | 중 |
| 18-F | 컨텍스트 메뉴 | 소 |
| 18-G | 키보드 단축키 | 소 |

### 7.2 우선순위 권장

**즉시 구현 (High Priority)**:
1. DELETE API (단일/다중)
2. 카드 체크박스 선택
3. 플로팅 액션 바
4. 기본 확인 다이얼로그

**추후 구현 (Medium Priority)**:
5. Toast + Undo
6. 컨텍스트 메뉴
7. 키보드 단축키

**나중 구현 (Low Priority)**:
8. 필터 기반 일괄 삭제
9. Soft Delete (휴지통)
10. 삭제 기록/감사 로그

---

## 8. 접근성 고려사항

### 8.1 키보드 접근성

| 키 | 동작 |
|----|------|
| `Space` | 카드 선택/해제 |
| `Delete` / `Backspace` | 선택된 항목 삭제 |
| `Ctrl+A` | 전체 선택 |
| `Escape` | 선택 모드 취소 |
| `Shift+클릭` | 범위 선택 |
| `Ctrl+클릭` | 개별 추가 선택 |

### 8.2 스크린 리더 지원

```tsx
<button
  aria-label={`문제 ${problem.number} 선택`}
  aria-checked={selected}
  role="checkbox"
>
  <Checkbox checked={selected} />
</button>
```

### 8.3 색상 대비

- 선택 상태: `ring-2 ring-blue-500` (색맹 사용자를 위해 테두리 추가)
- 삭제 버튼: `bg-red-500` + 아이콘 (색상만 의존하지 않음)

---

## 9. 결론 및 권장사항

### 9.1 핵심 권장사항

1. **Gmail 스타일 다중 선택**을 기본 패턴으로 채택
2. **Undo 기능**을 필수로 구현 (실수 방지)
3. **단계별 확인**으로 대량 삭제 보호
4. **플로팅 액션 바**로 선택 상태 명확히 표시

### 9.2 사용자 경험 목표

| 목표 | 측정 기준 |
|------|----------|
| 빠른 단일 삭제 | 3클릭 이내 |
| 다중 선택 삭제 | 선택 + 1클릭 |
| 실수 복구 | 5초 내 Undo |
| 학습 용이성 | 설명 없이 사용 가능 |

### 9.3 구현 시작점

**최소 기능 제품(MVP)**:
1. DELETE `/api/hangul/problems/{id}` API
2. 카드에 삭제 버튼 (호버 시 표시)
3. 확인 다이얼로그
4. 성공 Toast 알림

이후 점진적으로 다중 선택, Undo, 컨텍스트 메뉴 등 추가

---

## 10. 참고 자료

### 10.1 UI 라이브러리 권장

| 컴포넌트 | 라이브러리 | 비고 |
|----------|-----------|------|
| Toast | react-hot-toast | Undo 지원 |
| Dialog | @radix-ui/dialog | 접근성 우수 |
| Checkbox | @radix-ui/checkbox | 이미 사용 중일 수 있음 |
| ContextMenu | @radix-ui/context-menu | 우클릭 메뉴 |

### 10.2 관련 문서

- [Nielsen Norman Group: Destructive Actions](https://www.nngroup.com/articles/confirmation-dialog/)
- [Material Design: Deletion Patterns](https://material.io/design/communication/confirmation-acknowledgement.html)
- [Apple HIG: Destructive Actions](https://developer.apple.com/design/human-interface-guidelines/patterns/modality)

---

*작성: Claude Code (Opus)*
*날짜: 2025-11-28*
