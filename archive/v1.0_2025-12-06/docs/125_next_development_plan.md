# 다음 단계 개발 계획

**작성일**: 2025-12-04
**기준**: Phase 44-45 완료 후

---

## 현재 상태 요약

### ✅ 완료된 Phase

| Phase | 내용 | 상태 |
|-------|------|------|
| 21 | Foundation Layer (토스 스타일 디자인) | ✅ 완료 |
| 29 | 라벨링 시스템 최적화 | ✅ 완료 |
| 43 | 그룹 ID 충돌 수정 (Upsert) | ✅ 완료 |
| 44 | 라벨링 안정화 (저장순서, 동기화, 로깅) | ✅ 완료 |
| 45 | 좌측 사이드바 표시 형식 | ✅ 완료 |

### 🔄 진행 가능한 Phase

| Phase | 내용 | 우선순위 |
|-------|------|----------|
| 45-B | 레거시 데이터 마이그레이션 | 선택적 |
| 31 | 싱글 탭 매칭 시스템 개선 | 중간 |
| 22 | Intelligence Layer (AI 기능) | 높음 |
| 23 | Application Layer (피드형 검수 UI) | 높음 |

---

## 권장 개발 순서

### Option A: 사용자 경험 우선 (권장)

```
Phase 46: 레거시 데이터 정리 (1시간)
    ↓
Phase 31: 매칭 시스템 UX 개선 (1-2일)
    ↓
Phase 22-B: LLM 자동 태깅 (3-5일)
    ↓
Phase 23-C: 피드형 검수 UI (5-7일)
```

### Option B: AI 기능 우선

```
Phase 22-A: Mathpix OCR 연동 (3-4일)
    ↓
Phase 22-B: LLM 자동 태깅 (5-7일)
    ↓
Phase 23-C: 피드형 검수 UI (5-7일)
```

---

## Phase 46: 레거시 데이터 정리 (선택)

**목표**: 기존 "문제 · L1번" → "베이직쎈 · 10p · 1번" 형식으로 업그레이드

### 46-A: 수동 재동기화 버튼
**예상 시간**: 30분

- [ ] UnifiedWorkPage에 "데이터 재동기화" 버튼 추가
- [ ] 클릭 시 `fullSync()` 호출하여 groups.json에서 재로드
- [ ] displayName 재생성

### 46-B: 자동 마이그레이션 스크립트 (선택)
**예상 시간**: 1시간

- [ ] 백엔드 API: `/api/sessions/{id}/migrate-displaynames`
- [ ] 모든 문제의 displayName을 새 형식으로 업데이트
- [ ] 세션 저장

---

## Phase 31-Extended: 매칭 시스템 UX 개선

**목표**: 현재 매칭 시스템의 사용성 개선

### 31-K: 자동 스크롤
**예상 시간**: 1시간

- [ ] 문제 선택 시 해당 그룹이 보이도록 자동 스크롤
- [ ] 연결 완료 시 다음 미연결 문제로 자동 이동

### 31-L: 연결 미리보기
**예상 시간**: 2시간

- [ ] 해설 그룹 호버 시 연결될 문제 하이라이트
- [ ] 드래그 중 연결선 표시

### 31-M: 일괄 연결
**예상 시간**: 3시간

- [ ] 문제 번호 순서대로 자동 매칭 제안
- [ ] "모두 연결" 버튼으로 일괄 처리

---

## Phase 22-B: LLM 자동 태깅 (핵심)

**목표**: AI가 문제를 분석하여 자동 태깅

### 22-B-1: Claude API 연동
**예상 시간**: 2시간

- [ ] Claude API 키 설정 (환경변수)
- [ ] 백엔드 서비스: `app/services/ai/claude_service.py`
- [ ] 비용 추적 (토큰 사용량)

### 22-B-2: 단원 분류 프롬프트
**예상 시간**: 4시간

- [ ] math_tree.json 컨텍스트 최적화
- [ ] Few-shot 예제 구성
- [ ] 응답 파싱 및 검증

### 22-B-3: 난이도 예측
**예상 시간**: 2시간

- [ ] 난이도 1-5 기준 정의
- [ ] 문제 유형별 난이도 기준
- [ ] 신뢰도 점수 포함

### 예상 결과
```json
{
  "classification": {
    "grade": "고등수학(상)",
    "majorUnit": "다항식",
    "middleUnit": "다항식의 연산",
    "minorUnit": "다항식의 덧셈과 뺄셈"
  },
  "difficulty": 3,
  "confidence": 0.92,
  "reasoning": "이차식의 기본 연산 문제로..."
}
```

---

## Phase 23-C: 피드형 검수 UI (핵심)

**목표**: 카드 기반 빠른 문제 검수

### 23-C-1: 검수 페이지 생성
**예상 시간**: 3시간

- [ ] 새 라우트: `/review/:sessionId`
- [ ] ReviewPage.tsx 생성
- [ ] 카드 스와이프 레이아웃

### 23-C-2: AI 태그 표시
**예상 시간**: 2시간

- [ ] AI 제안 배지 표시
- [ ] 신뢰도에 따른 스타일 (높음: 파랑, 낮음: 회색)
- [ ] 클릭하여 수정

### 23-C-3: 키보드 단축키
**예상 시간**: 2시간

- [ ] Enter: 승인 → 다음
- [ ] E: 태그 편집 모달
- [ ] ←→: 이전/다음 문제
- [ ] 1-5: 난이도 직접 입력

### UI 목업
```
┌─────────────────────────────────────────────────────────┐
│  문제 검수 (12/45)                   [← →] ⌘K 검색     │
├─────────────────────────────────────────────────────────┤
│                                                          │
│   ┌────────────────────────────────────────────────┐    │
│   │                                                │    │
│   │         [문제 이미지 크롭]                      │    │
│   │                                                │    │
│   └────────────────────────────────────────────────┘    │
│                                                          │
│   ┌─────────────┐ ┌──────────────┐ ┌──────────┐        │
│   │ 고등수학(상) │ │ 다항식 연산   │ │ 난이도 3  │        │
│   │   AI 92%    │ │    AI 88%    │ │  AI 85%  │        │
│   └─────────────┘ └──────────────┘ └──────────┘        │
│                                                          │
│   ┌──────────────────┐  ┌──────────────────┐           │
│   │    ✓ 승인 (Enter) │  │    ✎ 수정 (E)    │           │
│   └──────────────────┘  └──────────────────┘           │
│                                                          │
│   진행률: ████████████░░░░ 27%                          │
└─────────────────────────────────────────────────────────┘
```

---

## 우선순위 권장

### 즉시 실행 (Quick Win)
1. **Phase 46-A**: 재동기화 버튼 (30분) - 레거시 데이터 해결
2. **Phase 31-K**: 자동 스크롤 (1시간) - UX 개선

### 단기 (1주일)
3. **Phase 22-B-1~2**: Claude API + 단원 분류 (6시간)

### 중기 (2주일)
4. **Phase 23-C**: 피드형 검수 UI (7일)

---

## 체크리스트

### Phase 46 (선택)
- [ ] 46-A: 재동기화 버튼

### Phase 31-Extended
- [ ] 31-K: 자동 스크롤
- [ ] 31-L: 연결 미리보기
- [ ] 31-M: 일괄 연결

### Phase 22-B
- [ ] 22-B-1: Claude API 연동
- [ ] 22-B-2: 단원 분류 프롬프트
- [ ] 22-B-3: 난이도 예측

### Phase 23-C
- [ ] 23-C-1: 검수 페이지 생성
- [ ] 23-C-2: AI 태그 표시
- [ ] 23-C-3: 키보드 단축키

---

*작성자: Claude Code*
*다음 단계: 사용자 승인 후 진행*
