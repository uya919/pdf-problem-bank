# Phase 31-H/I/J: í†µí•© ê°œë°œ ê³„íš

**ì‘ì„±ì¼**: 2025-12-03
**Phase**: 31 (ì‹±ê¸€ íƒ­ ë§¤ì¹­ ì‹œìŠ¤í…œ ê°•í™”)
**ê¸°ë°˜ ë¬¸ì„œ**:
- [51_phase31_feature_feasibility_report.md](51_phase31_feature_feasibility_report.md)
- [52_canvas_zoom_deep_research_report.md](52_canvas_zoom_deep_research_report.md)

---

## ê°œìš”

### êµ¬í˜„ ëª©í‘œ

| Phase | ê¸°ëŠ¥ | ìš°ì„ ìˆœìœ„ | ì˜ˆìƒ ì‹œê°„ |
|-------|------|---------|----------|
| **31-H** | ë¬¸ì œ ì •ë³´ í¸ì§‘ | 1ìˆœìœ„ (í•„ìˆ˜) | 3-4ì‹œê°„ |
| **31-I** | íŒ¨ë„ ë¦¬ì‚¬ì´ì¦ˆ | 2ìˆœìœ„ (ìœ ìš©) | 2-3ì‹œê°„ |
| **31-J** | ìº”ë²„ìŠ¤ ì¤Œ | 3ìˆœìœ„ (ì„ íƒ) | 3-4ì‹œê°„ |

### ì˜ì¡´ ê´€ê³„

```
Phase 31-H (ë¬¸ì œ ì •ë³´ í¸ì§‘)
     â†“
Phase 31-I (íŒ¨ë„ ë¦¬ì‚¬ì´ì¦ˆ) â† ë…ë¦½ì , ë³‘ë ¬ ê°€ëŠ¥
     â†“
Phase 31-J (ìº”ë²„ìŠ¤ ì¤Œ) â† ë…ë¦½ì , ë³‘ë ¬ ê°€ëŠ¥
```

---

## Phase 31-H: ë¬¸ì œ ì •ë³´ í¸ì§‘

### ëª©í‘œ
ProblemListPanelì—ì„œ ë¬¸ì œë²ˆí˜¸, ì±…ì´ë¦„, í˜ì´ì§€ ë“±ì„ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ í•¨

### ê¸°ìˆ  ì„¤ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProblemListPanel                                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ProblemItem (í¸ì§‘ ëª¨ë“œ OFF)                          â”‚    â”‚
â”‚  â”‚  [1] ë² ì´ì§ìˆ_ê³µí†µìˆ˜í•™1_p18        [âœï¸] [ğŸ—‘ï¸]       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â†“ í´ë¦­                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ProblemItem (í¸ì§‘ ëª¨ë“œ ON)                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ ì±…ì´ë¦„: [ë² ì´ì§ìˆ          ]                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ ê³¼ì •:   [ê³µí†µìˆ˜í•™1         ]                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ í˜ì´ì§€: [18] ë¬¸í•­ë²ˆí˜¸: [1  ]                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚              [ì €ì¥] [ì·¨ì†Œ]                   â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### êµ¬í˜„ ë‹¨ê³„

#### H-1: matchingStore í™•ì¥ (30ë¶„)
```typescript
// stores/matchingStore.ts

interface MatchingStore {
  // ... ê¸°ì¡´ ìƒíƒœ

  // ì¶”ê°€: ë¬¸ì œ ì •ë³´ ì—…ë°ì´íŠ¸
  updateProblemInfo: (groupId: string, info: {
    problemNumber?: string;
    displayName?: string;
    bookName?: string;
    course?: string;
    page?: number;
  }) => void;
}

// êµ¬í˜„
updateProblemInfo: (groupId, info) => {
  set((state) => ({
    problems: state.problems.map(p =>
      p.groupId === groupId
        ? { ...p, ...info, displayName: formatDisplayName(info) }
        : p
    ),
  }));
}
```

#### H-2: ProblemEditForm ì»´í¬ë„ŒíŠ¸ ìƒì„± (1ì‹œê°„)
```typescript
// components/unified/ProblemEditForm.tsx

interface ProblemEditFormProps {
  problem: ProblemItem;
  onSave: (updates: Partial<ProblemItem>) => void;
  onCancel: () => void;
}

export function ProblemEditForm({ problem, onSave, onCancel }: ProblemEditFormProps) {
  const [form, setForm] = useState({
    problemNumber: problem.problemNumber,
    // displayNameì—ì„œ íŒŒì‹± ë˜ëŠ” ë³„ë„ ì €ì¥ëœ ê°’ ì‚¬ìš©
  });

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      onSave(form);
    } else if (e.key === 'Escape') {
      e.preventDefault();
      onCancel();
    }
  };

  return (
    <div className="space-y-2 p-3 bg-blue-50 rounded-lg" onKeyDown={handleKeyDown}>
      {/* í¼ í•„ë“œë“¤ - GroupPanel ì°¸ê³  */}
    </div>
  );
}
```

#### H-3: ProblemListPanel ìˆ˜ì • (1ì‹œê°„)
```typescript
// components/unified/ProblemListPanel.tsx

export function ProblemListPanel() {
  const [editingId, setEditingId] = useState<string | null>(null);
  const { problems, updateProblemInfo } = useMatchingStore();

  return (
    <div>
      {problems.map((problem) => (
        editingId === problem.groupId ? (
          <ProblemEditForm
            key={problem.groupId}
            problem={problem}
            onSave={(updates) => {
              updateProblemInfo(problem.groupId, updates);
              setEditingId(null);
            }}
            onCancel={() => setEditingId(null)}
          />
        ) : (
          <ProblemItem
            key={problem.groupId}
            problem={problem}
            onEdit={() => setEditingId(problem.groupId)}
          />
        )
      ))}
    </div>
  );
}
```

#### H-4: ê·¸ë£¹ JSON ë™ê¸°í™” (1ì‹œê°„)
```typescript
// MatchingCanvas.tsx ë˜ëŠ” ë³„ë„ í›…

// ë¬¸ì œ ì •ë³´ ë³€ê²½ ì‹œ í•´ë‹¹ í˜ì´ì§€ì˜ ê·¸ë£¹ JSONë„ ì—…ë°ì´íŠ¸
const syncProblemInfoToGroup = useCallback(async (
  groupId: string,
  problemInfo: ProblemInfo
) => {
  // í•´ë‹¹ ê·¸ë£¹ì´ ìˆëŠ” í˜ì´ì§€ ì°¾ê¸°
  const problem = problems.find(p => p.groupId === groupId);
  if (!problem) return;

  // í•´ë‹¹ í˜ì´ì§€ ê·¸ë£¹ ë°ì´í„° ì¡°íšŒ
  const pageGroups = await fetchPageGroups(problem.documentId, problem.pageIndex);

  // í•´ë‹¹ ê·¸ë£¹ì˜ problemInfo ì—…ë°ì´íŠ¸
  const updatedGroups = pageGroups.map(g =>
    g.id === groupId ? { ...g, problemInfo } : g
  );

  // ì €ì¥
  await savePageGroups(problem.documentId, problem.pageIndex, updatedGroups);
}, [problems]);
```

#### H-5: í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ (30ë¶„)
```typescript
// Eí‚¤ë¡œ ì„ íƒëœ ë¬¸ì œ í¸ì§‘ ëª¨ë“œ ì§„ì…
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if (e.key === 'e' || e.key === 'E') {
      if (selectedProblemId && !editingId) {
        setEditingId(selectedProblemId);
      }
    }
  };
  // ...
}, [selectedProblemId, editingId]);
```

### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] H-1: matchingStore.updateProblemInfo êµ¬í˜„
- [ ] H-2: ProblemEditForm ì»´í¬ë„ŒíŠ¸ ìƒì„±
- [ ] H-3: ProblemListPanel í¸ì§‘ ëª¨ë“œ í†µí•©
- [ ] H-4: ê·¸ë£¹ JSON ë™ê¸°í™” ë¡œì§
- [ ] H-5: Eí‚¤ í¸ì§‘ ë‹¨ì¶•í‚¤
- [ ] H-6: í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •

---

## Phase 31-I: íŒ¨ë„ ë¦¬ì‚¬ì´ì¦ˆ

### ëª©í‘œ
ì˜¤ë¥¸ìª½ ë¬¸ì œ ëª©ë¡ íŒ¨ë„ì˜ ë„ˆë¹„ë¥¼ ë“œë˜ê·¸ë¡œ ì¡°ì ˆí•  ìˆ˜ ìˆê²Œ í•¨

### ê¸°ìˆ  ì„¤ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UnifiedMatchingPage                                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                               â”‚â–â”‚                  â”‚     â”‚
â”‚  â”‚    MatchingCanvas             â”‚â–â”‚ ProblemListPanel â”‚     â”‚
â”‚  â”‚    (flex-1)                   â”‚â–â”‚ (resizable)      â”‚     â”‚
â”‚  â”‚                               â”‚â–â”‚                  â”‚     â”‚
â”‚  â”‚                               â”‚â–â”‚                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                  â†‘                          â”‚
â”‚                           ResizeHandle                       â”‚
â”‚                        (cursor: col-resize)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### êµ¬í˜„ ë‹¨ê³„

#### I-1: ë¦¬ì‚¬ì´ì¦ˆ ìƒíƒœ ê´€ë¦¬ (20ë¶„)
```typescript
// pages/UnifiedMatchingPage.tsx

const MIN_PANEL_WIDTH = 240;  // ìµœì†Œ ë„ˆë¹„
const MAX_PANEL_WIDTH = 480;  // ìµœëŒ€ ë„ˆë¹„
const DEFAULT_PANEL_WIDTH = 320;  // ê¸°ë³¸ ë„ˆë¹„ (w-80)

const [panelWidth, setPanelWidth] = useState(() => {
  // localStorageì—ì„œ ì €ì¥ëœ ê°’ ë³µì›
  const saved = localStorage.getItem('matching-panel-width');
  return saved ? parseInt(saved, 10) : DEFAULT_PANEL_WIDTH;
});

// ë„ˆë¹„ ë³€ê²½ ì‹œ ì €ì¥
useEffect(() => {
  localStorage.setItem('matching-panel-width', String(panelWidth));
}, [panelWidth]);
```

#### I-2: ResizeHandle ì»´í¬ë„ŒíŠ¸ (40ë¶„)
```typescript
// components/unified/ResizeHandle.tsx

interface ResizeHandleProps {
  onResize: (deltaX: number) => void;
  onResizeEnd: () => void;
}

export function ResizeHandle({ onResize, onResizeEnd }: ResizeHandleProps) {
  const [isDragging, setIsDragging] = useState(false);
  const startXRef = useRef(0);

  const handleMouseDown = (e: React.MouseEvent) => {
    e.preventDefault();
    setIsDragging(true);
    startXRef.current = e.clientX;

    const handleMouseMove = (moveEvent: MouseEvent) => {
      const delta = startXRef.current - moveEvent.clientX;
      startXRef.current = moveEvent.clientX;
      onResize(delta);
    };

    const handleMouseUp = () => {
      setIsDragging(false);
      onResizeEnd();
      window.removeEventListener('mousemove', handleMouseMove);
      window.removeEventListener('mouseup', handleMouseUp);
    };

    window.addEventListener('mousemove', handleMouseMove);
    window.addEventListener('mouseup', handleMouseUp);
  };

  return (
    <div
      className={`w-1 flex-shrink-0 cursor-col-resize transition-colors ${
        isDragging ? 'bg-blue-500' : 'bg-gray-200 hover:bg-blue-400'
      }`}
      onMouseDown={handleMouseDown}
    />
  );
}
```

#### I-3: UnifiedMatchingPage í†µí•© (30ë¶„)
```typescript
// pages/UnifiedMatchingPage.tsx

const handleResize = useCallback((delta: number) => {
  setPanelWidth(prev => {
    const newWidth = prev + delta;
    return Math.max(MIN_PANEL_WIDTH, Math.min(MAX_PANEL_WIDTH, newWidth));
  });
}, []);

return (
  <div className="flex-1 flex overflow-hidden">
    {/* ìº”ë²„ìŠ¤ ì˜ì—­ */}
    <div className="flex-1 overflow-hidden bg-white">
      <MatchingCanvas ... />
    </div>

    {/* ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ */}
    <ResizeHandle
      onResize={handleResize}
      onResizeEnd={() => {/* ì €ì¥ì€ useEffectì—ì„œ */}}
    />

    {/* ë¬¸ì œ ëª©ë¡ íŒ¨ë„ - ê³ ì • ë„ˆë¹„ ëŒ€ì‹  ë™ì  ë„ˆë¹„ */}
    <div
      className="flex-shrink-0 border-l bg-white overflow-hidden"
      style={{ width: panelWidth }}
    >
      <ProblemListPanel />
    </div>
  </div>
);
```

#### I-4: ìº”ë²„ìŠ¤ ë¦¬ë Œë”ë§ ìµœì í™” (30ë¶„)
```typescript
// ë””ë°”ìš´ìŠ¤ë¡œ ì¦ì€ ë¦¬ë Œë”ë§ ë°©ì§€
const debouncedWidth = useDebounce(panelWidth, 100);

// MatchingCanvasëŠ” debouncedWidth ë³€ê²½ ì‹œì—ë§Œ ë¦¬ë Œë”
// (ë‚´ë¶€ containerRef.current.offsetWidthë¡œ ìë™ ì¡°ì •ë¨)
```

### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] I-1: ë¦¬ì‚¬ì´ì¦ˆ ìƒíƒœ + localStorage ì €ì¥
- [ ] I-2: ResizeHandle ì»´í¬ë„ŒíŠ¸ ìƒì„±
- [ ] I-3: UnifiedMatchingPage ë ˆì´ì•„ì›ƒ ìˆ˜ì •
- [ ] I-4: ìº”ë²„ìŠ¤ ë¦¬ì‚¬ì´ì¦ˆ ìµœì í™”
- [ ] I-5: ë”ë¸”í´ë¦­ ë¦¬ì…‹ (ê¸°ë³¸ ë„ˆë¹„ë¡œ)
- [ ] I-6: í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •

---

## Phase 31-J: ìº”ë²„ìŠ¤ ì¤Œ

### ëª©í‘œ
PDF ìº”ë²„ìŠ¤ë¥¼ í™•ëŒ€/ì¶•ì†Œí•˜ì—¬ ì„¸ë°€í•œ ë¸”ë¡ ì„ íƒ ê°€ëŠ¥

### ê¸°ìˆ  ì„¤ê³„: Stage ìŠ¤ì¼€ì¼ë§ ë°©ì‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MatchingCanvas                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ZoomControls                                         â”‚    â”‚
â”‚  â”‚  [50%] [75%] [100%] [125%] [150%] [ğŸ”„]              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ PageCanvas (with Stage scaling)                      â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚   Stage (scaleX={zoom}, scaleY={zoom})              â”‚    â”‚
â”‚  â”‚     â””â”€ Layer                                        â”‚    â”‚
â”‚  â”‚         â”œâ”€ Image (ì›ë³¸ ì¢Œí‘œ)                         â”‚    â”‚
â”‚  â”‚         â””â”€ Blocks (ì›ë³¸ ì¢Œí‘œ - ë³€í™˜ ë¶ˆí•„ìš”!)          â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  [zoom > 100%ì¼ ë•Œ: ìŠ¤í¬ë¡¤/íŒ¨ë‹ í™œì„±í™”]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ì›ë¦¬

```typescript
// ê¸°ì¡´ ë°©ì‹: ëª¨ë“  ë¸”ë¡ ê°œë³„ ê³„ì‚°
blocks.map(b => ({
  x: b.bbox[0] * scale * zoom,  // ë§¤ë²ˆ ê³„ì‚°
  y: b.bbox[1] * scale * zoom,
}))

// Stage ìŠ¤ì¼€ì¼ë§: Stageë§Œ í•œ ë²ˆ ìŠ¤ì¼€ì¼
<Stage scaleX={zoom} scaleY={zoom}>
  <Layer>
    {blocks.map(b => (
      <Rect x={b.bbox[0]} y={b.bbox[1]} />  // ì›ë³¸ ì¢Œí‘œ ê·¸ëŒ€ë¡œ!
    ))}
  </Layer>
</Stage>
```

### êµ¬í˜„ ë‹¨ê³„

#### J-1: ì¤Œ ìƒíƒœ ê´€ë¦¬ (20ë¶„)
```typescript
// components/PageCanvas.tsx ë˜ëŠ” MatchingCanvas.tsx

interface ZoomState {
  scale: number;        // 1.0 = 100%
  position: { x: number; y: number };  // íŒ¨ë‹ ìœ„ì¹˜
}

const ZOOM_LEVELS = [0.5, 0.75, 1, 1.25, 1.5, 2];
const MIN_ZOOM = 0.5;
const MAX_ZOOM = 2;

const [zoomState, setZoomState] = useState<ZoomState>({
  scale: 1,
  position: { x: 0, y: 0 }
});
```

#### J-2: ZoomControls ì»´í¬ë„ŒíŠ¸ (40ë¶„)
```typescript
// components/unified/ZoomControls.tsx

interface ZoomControlsProps {
  zoom: number;
  onZoomChange: (zoom: number) => void;
  onReset: () => void;
}

export function ZoomControls({ zoom, onZoomChange, onReset }: ZoomControlsProps) {
  return (
    <div className="flex items-center gap-1 p-2 bg-white border-b">
      {ZOOM_LEVELS.map((level) => (
        <button
          key={level}
          onClick={() => onZoomChange(level)}
          className={`px-2 py-1 text-xs rounded ${
            zoom === level
              ? 'bg-blue-500 text-white'
              : 'bg-gray-100 hover:bg-gray-200'
          }`}
        >
          {level * 100}%
        </button>
      ))}
      <button
        onClick={onReset}
        className="p-1 ml-2 hover:bg-gray-100 rounded"
        title="ì¤Œ ë¦¬ì…‹"
      >
        <RotateCcw className="w-4 h-4" />
      </button>
      <span className="ml-auto text-xs text-gray-500">
        Ctrl+íœ : ì¤Œ
      </span>
    </div>
  );
}
```

#### J-3: PageCanvas Stage ìŠ¤ì¼€ì¼ë§ ìˆ˜ì • (1ì‹œê°„)
```typescript
// components/PageCanvas.tsx

export const PageCanvas = memo(function PageCanvas({
  documentId,
  pageIndex,
  blocks,
  groups,
  selectedBlocks,
  onBlockSelect,
  onGroupCreate,
  // ì¶”ê°€ props
  zoom = 1,
  onZoomChange,
}: PageCanvasProps) {
  const [position, setPosition] = useState({ x: 0, y: 0 });

  // íœ  ì¤Œ í•¸ë“¤ëŸ¬
  const handleWheel = useCallback((e: Konva.KonvaEventObject<WheelEvent>) => {
    // Ctrl í‚¤ì™€ í•¨ê»˜ì¼ ë•Œë§Œ ì¤Œ
    if (!e.evt.ctrlKey) return;

    e.evt.preventDefault();

    const stage = e.target.getStage();
    if (!stage) return;

    const oldScale = zoom;
    const pointer = stage.getPointerPosition()!;

    // ì¤Œ ë°©í–¥ ë° ìƒˆ ìŠ¤ì¼€ì¼ ê³„ì‚°
    const scaleBy = 1.15;
    const newScale = e.evt.deltaY < 0
      ? Math.min(oldScale * scaleBy, MAX_ZOOM)
      : Math.max(oldScale / scaleBy, MIN_ZOOM);

    // í¬ì¸í„° ìœ„ì¹˜ ê¸°ì¤€ ì¤Œ
    const mousePointTo = {
      x: (pointer.x - position.x) / oldScale,
      y: (pointer.y - position.y) / oldScale,
    };

    const newPos = {
      x: pointer.x - mousePointTo.x * newScale,
      y: pointer.y - mousePointTo.y * newScale,
    };

    onZoomChange?.(newScale);
    setPosition(newPos);
  }, [zoom, position, onZoomChange]);

  // ì¤Œ > 100%ì¼ ë•Œ ë“œë˜ê·¸ íŒ¨ë‹
  const handleDragEnd = useCallback((e: Konva.KonvaEventObject<DragEvent>) => {
    if (zoom <= 1) return;
    setPosition({
      x: e.target.x(),
      y: e.target.y(),
    });
  }, [zoom]);

  return (
    <Stage
      ref={stageRef}
      width={canvasSize.width}
      height={canvasSize.height}
      scaleX={zoom}
      scaleY={zoom}
      x={position.x}
      y={position.y}
      draggable={zoom > 1}
      onWheel={handleWheel}
      onDragEnd={handleDragEnd}
    >
      <Layer>
        {/* ì´ë¯¸ì§€ - ì›ë³¸ í¬ê¸° */}
        <Image image={image} width={imageWidth} height={imageHeight} />

        {/* ë¸”ë¡ - ì›ë³¸ ì¢Œí‘œ ê·¸ëŒ€ë¡œ! */}
        {blocks.map((block) => {
          const [x1, y1, x2, y2] = block.bbox;
          return (
            <Rect
              key={block.block_id}
              x={x1}      // ìŠ¤ì¼€ì¼ ê³±ì…ˆ ì—†ìŒ!
              y={y1}
              width={x2 - x1}
              height={y2 - y1}
              // ...
            />
          );
        })}
      </Layer>
    </Stage>
  );
});
```

#### J-4: í´ë¦­ ì¢Œí‘œ ë³€í™˜ (40ë¶„)
```typescript
// Stage ìŠ¤ì¼€ì¼ë§ ì‚¬ìš© ì‹œ í´ë¦­ ì¢Œí‘œ ë³€í™˜

const handleBlockClick = useCallback((e: Konva.KonvaEventObject<MouseEvent>) => {
  const stage = e.target.getStage();
  if (!stage) return;

  // Stageì˜ getPointerPosition()ì€ ìŠ¤ì¼€ì¼/íŒ¨ë‹ ì ìš© ì „ ì¢Œí‘œ
  const pointer = stage.getPointerPosition()!;

  // ì‹¤ì œ ì´ë¯¸ì§€ ì¢Œí‘œë¡œ ë³€í™˜
  const imageX = (pointer.x - position.x) / zoom;
  const imageY = (pointer.y - position.y) / zoom;

  // ë¸”ë¡ ì¶©ëŒ ê²€ì‚¬
  const clickedBlock = blocks.find(block => {
    const [x1, y1, x2, y2] = block.bbox;
    return imageX >= x1 && imageX <= x2 && imageY >= y1 && imageY <= y2;
  });

  if (clickedBlock) {
    onBlockSelect(clickedBlock.block_id, e.evt.ctrlKey);
  }
}, [blocks, zoom, position, onBlockSelect]);
```

#### J-5: ë“œë˜ê·¸ ì„ íƒ ì¢Œí‘œ ë³€í™˜ (40ë¶„)
```typescript
// ë“œë˜ê·¸ ì˜ì—­ë„ ë™ì¼í•˜ê²Œ ë³€í™˜

const handleDragSelect = useCallback(() => {
  if (!dragStart || !dragEnd) return;

  // í™”ë©´ ì¢Œí‘œ â†’ ì´ë¯¸ì§€ ì¢Œí‘œ ë³€í™˜
  const startImg = {
    x: (dragStart.x - position.x) / zoom,
    y: (dragStart.y - position.y) / zoom,
  };
  const endImg = {
    x: (dragEnd.x - position.x) / zoom,
    y: (dragEnd.y - position.y) / zoom,
  };

  const selectionRect = {
    x1: Math.min(startImg.x, endImg.x),
    y1: Math.min(startImg.y, endImg.y),
    x2: Math.max(startImg.x, endImg.x),
    y2: Math.max(startImg.y, endImg.y),
  };

  // ì›ë³¸ ì¢Œí‘œ ê¸°ì¤€ìœ¼ë¡œ ì¶©ëŒ ê²€ì‚¬
  const selectedBlockIds = blocks
    .filter(block => isRectOverlap(selectionRect, {
      x1: block.bbox[0],
      y1: block.bbox[1],
      x2: block.bbox[2],
      y2: block.bbox[3],
    }))
    .map(b => b.block_id);

  // ...
}, [dragStart, dragEnd, zoom, position, blocks]);
```

#### J-6: ì¤Œ ë¦¬ì…‹ ë° í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ (20ë¶„)
```typescript
// ë”ë¸”í´ë¦­ ë˜ëŠ” ë²„íŠ¼ìœ¼ë¡œ ì¤Œ ë¦¬ì…‹
const resetZoom = useCallback(() => {
  setZoomState({ scale: 1, position: { x: 0, y: 0 } });
}, []);

// í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
// Ctrl++ : ì¤Œ ì¸
// Ctrl+- : ì¤Œ ì•„ì›ƒ
// Ctrl+0 : ì¤Œ ë¦¬ì…‹
```

### ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] J-1: ì¤Œ ìƒíƒœ ê´€ë¦¬ (scale, position)
- [ ] J-2: ZoomControls UI ì»´í¬ë„ŒíŠ¸
- [ ] J-3: PageCanvas Stage ìŠ¤ì¼€ì¼ë§ ì ìš©
- [ ] J-4: í´ë¦­ ì¢Œí‘œ ë³€í™˜ ë¡œì§
- [ ] J-5: ë“œë˜ê·¸ ì„ íƒ ì¢Œí‘œ ë³€í™˜
- [ ] J-6: ì¤Œ ë¦¬ì…‹ + í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
- [ ] J-7: í˜ì´ì§€/íƒ­ ì „í™˜ ì‹œ ì¤Œ ë¦¬ì…‹
- [ ] J-8: í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •

---

## ì „ì²´ êµ¬í˜„ ìˆœì„œ

```
Day 1: Phase 31-H (ë¬¸ì œ ì •ë³´ í¸ì§‘)
â”œâ”€ H-1 ~ H-3: ê¸°ë³¸ í¸ì§‘ UI (2ì‹œê°„)
â”œâ”€ H-4: ê·¸ë£¹ JSON ë™ê¸°í™” (1ì‹œê°„)
â””â”€ H-5 ~ H-6: ë‹¨ì¶•í‚¤ ë° í…ŒìŠ¤íŠ¸ (1ì‹œê°„)

Day 2: Phase 31-I (íŒ¨ë„ ë¦¬ì‚¬ì´ì¦ˆ)
â”œâ”€ I-1 ~ I-2: ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ (1ì‹œê°„)
â”œâ”€ I-3 ~ I-4: ë ˆì´ì•„ì›ƒ í†µí•© (1ì‹œê°„)
â””â”€ I-5 ~ I-6: ë§ˆë¬´ë¦¬ (0.5ì‹œê°„)

Day 2~3: Phase 31-J (ìº”ë²„ìŠ¤ ì¤Œ) - ì„ íƒ
â”œâ”€ J-1 ~ J-2: ì¤Œ UI (1ì‹œê°„)
â”œâ”€ J-3: Stage ìŠ¤ì¼€ì¼ë§ (1ì‹œê°„)
â”œâ”€ J-4 ~ J-5: ì¢Œí‘œ ë³€í™˜ (1.5ì‹œê°„)
â””â”€ J-6 ~ J-8: ë§ˆë¬´ë¦¬ (0.5ì‹œê°„)
```

---

## ìˆ˜ì • ëŒ€ìƒ íŒŒì¼

| íŒŒì¼ | Phase H | Phase I | Phase J |
|------|---------|---------|---------|
| `stores/matchingStore.ts` | âœ… ìˆ˜ì • | - | - |
| `components/unified/ProblemListPanel.tsx` | âœ… ìˆ˜ì • | - | - |
| `components/unified/ProblemEditForm.tsx` | âœ… ì‹ ê·œ | - | - |
| `components/unified/ResizeHandle.tsx` | - | âœ… ì‹ ê·œ | - |
| `components/unified/ZoomControls.tsx` | - | - | âœ… ì‹ ê·œ |
| `pages/UnifiedMatchingPage.tsx` | - | âœ… ìˆ˜ì • | - |
| `components/PageCanvas.tsx` | - | - | âœ… ìˆ˜ì • |
| `components/unified/MatchingCanvas.tsx` | âš ï¸ ì—°ë™ | - | âœ… ìˆ˜ì • |

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### Phase 31-H í…ŒìŠ¤íŠ¸
1. ë¬¸ì œ ì•„ì´í…œ í´ë¦­ â†’ í¸ì§‘ ëª¨ë“œ ì§„ì…
2. ë¬¸ì œë²ˆí˜¸ ìˆ˜ì • â†’ Enter â†’ ì €ì¥ í™•ì¸
3. ESCë¡œ ì·¨ì†Œ â†’ ì›ë˜ ê°’ ìœ ì§€
4. Eí‚¤ë¡œ ì„ íƒëœ ë¬¸ì œ í¸ì§‘ ëª¨ë“œ ì§„ì…
5. ì €ì¥ í›„ ê·¸ë£¹ JSON ë™ê¸°í™” í™•ì¸

### Phase 31-I í…ŒìŠ¤íŠ¸
1. ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ë“œë˜ê·¸ â†’ íŒ¨ë„ ë„ˆë¹„ ë³€ê²½
2. ìµœì†Œ/ìµœëŒ€ ë„ˆë¹„ ì œí•œ í™•ì¸
3. ìƒˆë¡œê³ ì¹¨ í›„ ë„ˆë¹„ ë³µì› í™•ì¸
4. ë”ë¸”í´ë¦­ìœ¼ë¡œ ê¸°ë³¸ ë„ˆë¹„ ë³µì›

### Phase 31-J í…ŒìŠ¤íŠ¸
1. ì¤Œ ë²„íŠ¼ í´ë¦­ â†’ ìŠ¤ì¼€ì¼ ë³€ê²½
2. Ctrl+íœ  â†’ í¬ì¸í„° ê¸°ì¤€ ì¤Œ
3. ì¤Œ > 100%ì—ì„œ ë“œë˜ê·¸ íŒ¨ë‹
4. ë¸”ë¡ í´ë¦­ ì •í™•ë„ (ì¢Œí‘œ ë³€í™˜)
5. ë“œë˜ê·¸ ì„ íƒ ì •í™•ë„
6. í˜ì´ì§€ ì „í™˜ ì‹œ ì¤Œ ë¦¬ì…‹

---

## ìœ„í—˜ ìš”ì†Œ ë° ëŒ€ì‘

| ìœ„í—˜ | í™•ë¥  | ëŒ€ì‘ |
|------|------|------|
| ê·¸ë£¹ JSON ë™ê¸°í™” ì‹¤íŒ¨ | ì¤‘ê°„ | ë¹„ë™ê¸° ì €ì¥ + ì¬ì‹œë„ ë¡œì§ |
| ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ìº”ë²„ìŠ¤ ê¹œë¹¡ì„ | ë‚®ìŒ | ë””ë°”ìš´ìŠ¤ + CSS transition |
| ì¤Œ ì‹œ ì¢Œí‘œ ë³€í™˜ ì˜¤ë¥˜ | ì¤‘ê°„ | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ + ì‹œê°ì  ë””ë²„ê¹… |
| ì„±ëŠ¥ ì €í•˜ (í° ì¤Œ) | ë‚®ìŒ | ì´ë¯¸ì§€ ìºì‹± + ë ˆì´ì–´ ìµœì í™” |

---

*ê³„íš ë*
