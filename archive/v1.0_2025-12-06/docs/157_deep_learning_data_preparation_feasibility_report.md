# ë”¥ëŸ¬ë‹ ë°ì´í„° ì¤€ë¹„ ê°€ëŠ¥ì„± ë¦¬í¬íŠ¸

**ë¬¸ì„œ ë²ˆí˜¸**: 157
**ì‘ì„±ì¼**: 2025-12-06
**ëª©ì **: ë¼ë²¨ë§ ë°ì´í„°ì˜ ë”¥ëŸ¬ë‹ í™œìš© ê°€ëŠ¥ì„± ë¶„ì„ ë° êµ¬í˜„ ë°©ì•ˆ

---

## 1. ìš”ì•½ (Executive Summary)

### ê²°ë¡ : êµ¬í˜„ ê°€ëŠ¥ì„± 95%

í˜„ì¬ ë¼ë²¨ë§ ì‹œìŠ¤í…œì´ ì €ì¥í•˜ëŠ” ë°ì´í„°ëŠ” **ì´ë¯¸ ë”¥ëŸ¬ë‹ì— í™œìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€**ì…ë‹ˆë‹¤.
- `groups.json`: ë¬¸ì œ ê·¸ë£¹ ì •ë³´ (block_ids, ìƒíƒœ, ë©”íƒ€ë°ì´í„°)
- `blocks.json`: ê°œë³„ ë¸”ë¡ì˜ bbox ì¢Œí‘œ, í˜ì´ì§€ í¬ê¸°

**í•„ìš”í•œ ì‘ì—…**: ìµœì†Œí•œì˜ ë°ì´í„° ë³´ê°• (combinedBbox ì €ì¥)
**ì˜ˆìƒ ê°œë°œëŸ‰**: ë°±ì—”ë“œ 1ê°œ í•¨ìˆ˜ ìˆ˜ì • (~30ì¤„)
**ìœ„í—˜ë„**: ë§¤ìš° ë‚®ìŒ (ê¸°ì¡´ ê¸°ëŠ¥ì— ì˜í–¥ ì—†ìŒ)

---

## 2. í˜„ì¬ ë°ì´í„° í¬ë§· ë¶„ì„

### 2.1 groups.json (ê·¸ë£¹ ë°ì´í„°)

```json
{
  "document_id": "ê³ 1_ê³µí†µìˆ˜í•™1_ë² ì´ì§ìˆ_ë¬¸ì œ",
  "page_index": 9,
  "groups": [
    {
      "id": "p9_L1",
      "column": "L",
      "block_ids": [153, 154, 155, 156, 157, 158],
      "status": "confirmed",
      "problemInfo": {
        "bookName": "ë² ì´ì§ìˆ",
        "course": "ê³µí†µìˆ˜í•™1",
        "page": 10,
        "problemNumber": "1",
        "displayName": "ë² ì´ì§ìˆ_ê³µí†µìˆ˜í•™1_p10_1ë²ˆ"
      }
    }
  ]
}
```

**ì €ì¥ë˜ëŠ” ì •ë³´**:
- âœ… ê·¸ë£¹ ID (ê³ ìœ  ì‹ë³„ì)
- âœ… ì†Œì† ë¸”ë¡ ëª©ë¡ (block_ids)
- âœ… í™•ì¸ ìƒíƒœ (pending/confirmed)
- âœ… ë¬¸ì œ ë©”íƒ€ë°ì´í„° (ì±…, ê³¼ì •, í˜ì´ì§€, ë¬¸ì œë²ˆí˜¸)
- âŒ **ê²°í•©ëœ bbox ì—†ìŒ** (block_idsë¡œë¶€í„° ê³„ì‚° í•„ìš”)

### 2.2 blocks.json (ë¸”ë¡ ë°ì´í„°)

```json
{
  "width": 1240,
  "height": 1754,
  "blocks": [
    {
      "block_id": 153,
      "column": "L",
      "bbox": [91, 232, 554, 394],
      "pixel_density": 0.18
    }
  ]
}
```

**ì €ì¥ë˜ëŠ” ì •ë³´**:
- âœ… í˜ì´ì§€ í¬ê¸° (width, height) - YOLO ì •ê·œí™”ì— í•„ìˆ˜
- âœ… ê°œë³„ ë¸”ë¡ bbox [x1, y1, x2, y2]
- âœ… ë¸”ë¡ ID (groups.jsonê³¼ ì—°ê²°)
- âœ… ì»¬ëŸ¼ ì •ë³´ (L/R)

### 2.3 YOLO í•™ìŠµì— í•„ìš”í•œ ë°ì´í„°

```
YOLO Format: <class_id> <x_center> <y_center> <width> <height>
- ëª¨ë“  ê°’ì€ 0~1 ì‚¬ì´ë¡œ ì •ê·œí™”
- class_id: ë¬¸ì œ ìœ í˜• (0=ì¼ë°˜ë¬¸ì œ, 1=í’€ì´, 2=ì˜ˆì œ ë“±)
```

**í˜„ì¬ ìƒíƒœì—ì„œ YOLO ë³€í™˜ ê°€ëŠ¥**:
```python
# í˜„ì¬ ë°ì´í„°ë¡œ YOLO í¬ë§· ìƒì„± ê°€ëŠ¥
def convert_to_yolo(groups_json, blocks_json):
    page_w, page_h = blocks_json['width'], blocks_json['height']
    blocks_map = {b['block_id']: b['bbox'] for b in blocks_json['blocks']}

    for group in groups_json['groups']:
        # block_idsë¡œë¶€í„° ê²°í•© bbox ê³„ì‚°
        bboxes = [blocks_map[bid] for bid in group['block_ids']]
        x1 = min(b[0] for b in bboxes)
        y1 = min(b[1] for b in bboxes)
        x2 = max(b[2] for b in bboxes)
        y2 = max(b[3] for b in bboxes)

        # YOLO ì •ê·œí™”
        x_center = ((x1 + x2) / 2) / page_w
        y_center = ((y1 + y2) / 2) / page_h
        width = (x2 - x1) / page_w
        height = (y2 - y1) / page_h

        yield f"0 {x_center:.6f} {y_center:.6f} {width:.6f} {height:.6f}"
```

---

## 3. êµ¬í˜„ ë°©ì•ˆ

### 3.1 Option A: í˜„ì¬ ê·¸ëŒ€ë¡œ ìœ ì§€ (ê¶Œì¥)

**ì¥ì **:
- ê°œë°œ ë¶ˆí•„ìš”
- ê¸°ì¡´ ì‹œìŠ¤í…œ ì•ˆì •ì„± ìœ ì§€
- ë‚´ë³´ë‚´ê¸° ì‹œì ì— bbox ê³„ì‚°

**ë‹¨ì **:
- ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± í•„ìš” (ë‚˜ì¤‘ì—)

**ê²°ë¡ **: í˜„ì¬ ë°ì´í„°ë§Œìœ¼ë¡œ ì¶©ë¶„íˆ YOLO í•™ìŠµ ê°€ëŠ¥

### 3.2 Option B: combinedBbox ì¶”ê°€ ì €ì¥

**ë³€ê²½ ì‚¬í•­**:
```json
{
  "id": "p9_L1",
  "block_ids": [153, 154, 155, 156],
  "combinedBbox": [91, 232, 554, 650],  // ì¶”ê°€
  "status": "confirmed"
}
```

**ì¥ì **:
- ë‚´ë³´ë‚´ê¸° ì‹œ ê³„ì‚° ë¶ˆí•„ìš”
- ë°ì´í„° ìì²´ë¡œ ì™„ê²°ì„±

**ë‹¨ì **:
- ë°±ì—”ë“œ ìˆ˜ì • í•„ìš” (~30ì¤„)
- ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ê³ ë ¤

---

## 4. ìš°ë ¤ ì‚¬í•­ ë° í•´ê²°ì±…

### 4.1 ìš°ë ¤: ê¸°ì¡´ ë°ì´í„° í˜¸í™˜ì„±

**í˜„ìƒ**: ì´ë¯¸ ì €ì¥ëœ groups.jsonì—ëŠ” combinedBboxê°€ ì—†ìŒ

**í•´ê²°ì±…**:
- ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë™ì  ê³„ì‚° (Option A ê¶Œì¥)
- ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì¼ê´„ ì¶”ê°€

### 4.2 ìš°ë ¤: ë¬¸ì œ ìœ í˜• ë¶„ë¥˜

**í˜„ìƒ**: í˜„ì¬ class_id êµ¬ë¶„ ì—†ìŒ (ëª¨ë“  ê·¸ë£¹ì´ "ë¬¸ì œ")

**í•´ê²°ì±…**:
- ê¸°ë³¸ê°’ class_id=0 (ì¼ë°˜ ë¬¸ì œ)
- ë‚˜ì¤‘ì— í•„ìš” ì‹œ problemInfoì— type í•„ë“œ ì¶”ê°€
- YOLOëŠ” ë‹¨ì¼ í´ë˜ìŠ¤ë¡œë„ í•™ìŠµ ê°€ëŠ¥

### 4.3 ìš°ë ¤: í•´ì„¤ ë¬¸ì„œì™€ì˜ ì—°ê²°

**í˜„ìƒ**: ë¬¸ì œ-í•´ì„¤ ì—°ê²° ì •ë³´(links)ëŠ” work_sessionì— ì €ì¥

**í•´ê²°ì±…**:
- ì´ˆê¸° ëª¨ë¸ì€ ë¬¸ì œ ì˜ì—­ ê²€ì¶œë§Œ ëª©í‘œ
- ë¬¸ì œ-í•´ì„¤ ë§¤ì¹­ì€ ë³„ë„ í›„ì²˜ë¦¬ë¡œ ê°€ëŠ¥

---

## 5. ë”¥ëŸ¬ë‹ í•™ìŠµ ë°ì´í„° ìš”êµ¬ëŸ‰

| ë°ì´í„°ëŸ‰ | ì˜ˆìƒ ì •í™•ë„ | ìš©ë„ |
|---------|-----------|------|
| 50 í˜ì´ì§€ | 60-70% | í”„ë¡œí† íƒ€ì…, ê°€ëŠ¥ì„± ê²€ì¦ |
| 100-200 í˜ì´ì§€ | 75-85% | ì‹¤ì‚¬ìš© ê°€ëŠ¥ (HITL í•„ìˆ˜) |
| 500+ í˜ì´ì§€ | 90%+ | ìë™í™” ìˆ˜ì¤€ |

**í˜„ì¬ ë¼ë²¨ë§ ìƒíƒœ**:
- 70+ groups.json íŒŒì¼ ì¡´ì¬ (ë¶„ì„ ê²°ê³¼)
- ëª©í‘œ: 100-200 í˜ì´ì§€ ë¼ë²¨ë§ í›„ 1ì°¨ í•™ìŠµ

---

## 6. ê¶Œì¥ ì‹¤í–‰ ê³„íš

### Phase A: í˜„ì¬ (ë³€ê²½ ì—†ìŒ)
```
âœ… ìˆ˜ë™ ë¼ë²¨ë§ ê³„ì† ì§„í–‰
âœ… í•™ì› ìˆ˜ì—…ì— ë¬¸ì œì€í–‰ í™œìš©
âœ… ë°ì´í„° ìì—°ìŠ¤ëŸ½ê²Œ ì¶•ì 
```

### Phase B: ë¼ë²¨ë§ 100í˜ì´ì§€ ë„ë‹¬ ì‹œ
```
â–¡ YOLO ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ
â–¡ Roboflowì— ì—…ë¡œë“œí•˜ì—¬ ê²€ì¦
â–¡ 1ì°¨ ëª¨ë¸ í•™ìŠµ í…ŒìŠ¤íŠ¸
```

### Phase C: ëª¨ë¸ ì •í™•ë„ 70%+ ë‹¬ì„± ì‹œ
```
â–¡ AI ìë™í™” ì›¹ì•± ê°œë°œ (docs/155 ì°¸ì¡°)
â–¡ Human-in-the-Loop ì›Œí¬í”Œë¡œìš° êµ¬í˜„
â–¡ Active Learningìœ¼ë¡œ ì§€ì† ê°œì„ 
```

---

## 7. ìµœì¢… ê²°ë¡ 

### êµ¬í˜„ ê°€ëŠ¥ì„±: 95%

| í•­ëª© | í‰ê°€ |
|------|------|
| í˜„ì¬ ë°ì´í„° í¬ë§· | âœ… ì¶©ë¶„í•¨ |
| ì¶”ê°€ ê°œë°œ í•„ìš”ì„± | âšª ì„ íƒì  (combinedBbox) |
| ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ | ğŸ”„ ë‚˜ì¤‘ì— ê°œë°œ |
| í•™ìŠµ ë°ì´í„°ëŸ‰ | ğŸ”„ ì¶•ì  ì¤‘ (70+ í˜ì´ì§€) |

### ê¶Œì¥ ì‚¬í•­

1. **ì§€ê¸ˆ ë‹¹ì¥ ê°œë°œí•  ê²ƒ ì—†ìŒ** - í˜„ì¬ ì €ì¥ í˜•ì‹ìœ¼ë¡œ ì¶©ë¶„
2. **ë¼ë²¨ë§ ì‘ì—… ê³„ì†** - í•™ì› ìˆ˜ì—… í™œìš© + ë°ì´í„° ì¶•ì 
3. **100í˜ì´ì§€ ë„ë‹¬ ì‹œ ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ** - ê·¸ë•Œ ìš”ì²­
4. **plan.mdì— AI ë¡œë“œë§µ ì¶”ê°€** - ë¯¸ë˜ ê°œë°œ ê°€ì´ë“œ

---

## 8. ê¸°ìˆ  ì„¸ë¶€ì‚¬í•­ (ì°¸ê³ ìš©)

### YOLO ë‚´ë³´ë‚´ê¸° ìŠ¤í¬ë¦½íŠ¸ (ë¯¸ë˜ ê°œë°œìš©)

```python
# export_yolo.py (ë‚˜ì¤‘ì— ê°œë°œ)
import json
from pathlib import Path

def export_to_yolo(document_id: str, output_dir: Path):
    """groups.json + blocks.json â†’ YOLO format"""

    groups_dir = Path(f"dataset_root/documents/{document_id}/groups")
    blocks_dir = Path(f"dataset_root/documents/{document_id}/blocks")
    pages_dir = Path(f"dataset_root/documents/{document_id}/pages")

    for groups_file in groups_dir.glob("page_*_groups.json"):
        page_idx = groups_file.stem.split("_")[1]
        blocks_file = blocks_dir / f"page_{page_idx}_blocks.json"

        with open(groups_file) as f:
            groups = json.load(f)
        with open(blocks_file) as f:
            blocks = json.load(f)

        # YOLO ë¼ë²¨ íŒŒì¼ ìƒì„±
        labels = []
        for group in groups['groups']:
            if group['status'] != 'confirmed':
                continue

            bbox = calculate_combined_bbox(group['block_ids'], blocks)
            yolo_line = to_yolo_format(bbox, blocks['width'], blocks['height'])
            labels.append(yolo_line)

        # ì €ì¥
        label_file = output_dir / "labels" / f"page_{page_idx}.txt"
        label_file.write_text("\n".join(labels))

        # ì´ë¯¸ì§€ ë³µì‚¬
        shutil.copy(
            pages_dir / f"page_{page_idx}.png",
            output_dir / "images" / f"page_{page_idx}.png"
        )
```

### í´ë” êµ¬ì¡° (YOLO í•™ìŠµìš©)

```
yolo_dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ page_0001.png
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ val/
â”‚       â””â”€â”€ ...
â”œâ”€â”€ labels/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ page_0001.txt
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ val/
â”‚       â””â”€â”€ ...
â””â”€â”€ data.yaml
```

---

*ì‘ì„±: Claude Code*
*ì°¸ì¡°: docs/154, docs/155, docs/156*
