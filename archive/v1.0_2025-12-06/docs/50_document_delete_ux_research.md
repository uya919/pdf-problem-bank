# 문서 삭제 UX 연구 리포트

**작성일**: 2025-12-02
**Phase**: 21.6+ (라벨링 UX 개선)
**목적**: 토스 스타일 UX 원칙에 맞는 문서 삭제 기능 설계

---

## 1. 현재 상태 분석

### 1.1 이미 구현된 기능

| 레이어 | 상태 | 위치 |
|--------|------|------|
| **Backend API** | ✅ 완료 | `DELETE /api/pdf/documents/{document_id}` |
| **API Client** | ✅ 완료 | `api.deleteDocument(documentId)` |
| **React Query Hook** | ✅ 완료 | `useDeleteDocument()` |
| **UI** | ❌ 미구현 | RegistrationPage에 삭제 버튼 없음 |

### 1.2 삭제 시 영향 범위

```
dataset_root/documents/{document_id}/
├── pages/          # 페이지 이미지 (삭제됨)
├── blocks/         # 블록 데이터 (삭제됨)
├── groups/         # 그룹 데이터 (삭제됨) ⚠️ 라벨링 작업 손실
└── problems/       # 내보낸 문제 (삭제됨) ⚠️ 중요 데이터 손실
```

**위험도**: 🔴 **High** - 라벨링 작업이 영구 삭제됨

---

## 2. 토스 스타일 UX 원칙

### 2.1 핵심 원칙

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     토스 스타일 삭제 UX 원칙                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1. 실수 방지 (Error Prevention)                                        │
│     ├── 삭제 버튼은 숨김 상태에서 시작                                  │
│     ├── 중요한 작업은 2단계 확인                                        │
│     └── 되돌릴 수 없음을 명확히 고지                                    │
│                                                                         │
│  2. 최소 단계 (Minimal Steps)                                           │
│     ├── 중요하지 않은 데이터: 1단계 (클릭만)                            │
│     └── 중요한 데이터: 2단계 (클릭 + 확인)                              │
│                                                                         │
│  3. 되돌리기 (Undo Support)                                             │
│     ├── 가능하면 Soft Delete (휴지통 이동)                              │
│     └── 불가능하면 명확한 경고                                          │
│                                                                         │
│  4. 명확한 피드백 (Clear Feedback)                                      │
│     ├── 삭제 성공: 토스트 알림                                          │
│     ├── 삭제 실패: 에러 메시지                                          │
│     └── 진행 중: 로딩 상태                                              │
│                                                                         │
│  5. 접근성 (Accessibility)                                              │
│     ├── 실수로 누르기 어려운 위치                                       │
│     └── 의도적 동작 필요 (스와이프, 메뉴 진입 등)                       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 삭제 UX 패턴 비교

### 3.1 패턴 A: 스와이프 삭제 (토스 뱅크 스타일)

```
┌─────────────────────────────────────────────────────────────────────────┐
│  패턴 A: 스와이프 삭제                                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  [문서 카드] ◄──── 왼쪽 스와이프 ────► [🗑️ 삭제]                       │
│                                                                         │
│  장점:                                                                  │
│  ├── 깔끔한 기본 UI (삭제 버튼 미노출)                                 │
│  ├── 의도적 제스처 필요                                                │
│  └── 모바일 친화적                                                      │
│                                                                         │
│  단점:                                                                  │
│  ├── 데스크톱에서 스와이프 어려움                                      │
│  ├── 발견성(discoverability) 낮음                                      │
│  └── 구현 복잡도 높음                                                   │
│                                                                         │
│  적합도: ⭐⭐⭐ (모바일 우선이면 좋음)                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 패턴 B: 더보기 메뉴 (권장)

```
┌─────────────────────────────────────────────────────────────────────────┐
│  패턴 B: 더보기 메뉴 (⋮ 또는 ⋯)                                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  📄 251128_중3 정규반_문제지                              [⋮]    │  │
│  │  16페이지 • 라벨링 대기                                          │  │
│  │                                                    [시작하기 →]  │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                         │              │
│                                                         ▼              │
│                                              ┌──────────────────┐      │
│                                              │  📝 이름 변경    │      │
│                                              │  📤 내보내기     │      │
│                                              │  ─────────────── │      │
│                                              │  🗑️ 삭제         │      │
│                                              └──────────────────┘      │
│                                                                         │
│  장점:                                                                  │
│  ├── 깔끔한 기본 UI                                                    │
│  ├── 확장 가능 (다른 액션 추가 용이)                                   │
│  ├── 데스크톱/모바일 모두 적합                                         │
│  └── 실수 방지 (2단계 필요)                                            │
│                                                                         │
│  단점:                                                                  │
│  └── 삭제까지 2번 클릭 필요                                            │
│                                                                         │
│  적합도: ⭐⭐⭐⭐⭐ (권장)                                              │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.3 패턴 C: 호버 시 삭제 버튼

```
┌─────────────────────────────────────────────────────────────────────────┐
│  패턴 C: 호버 시 삭제 버튼 노출                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  [기본 상태]                                                            │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  📄 251128_중3 정규반_문제지                                     │  │
│  │  16페이지 • 라벨링 대기                      [시작하기 →]        │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  [호버 상태]                                                            │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  📄 251128_중3 정규반_문제지                             [🗑️]   │  │
│  │  16페이지 • 라벨링 대기                      [시작하기 →]        │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  장점:                                                                  │
│  ├── 빠른 접근                                                         │
│  └── 깔끔한 기본 UI                                                    │
│                                                                         │
│  단점:                                                                  │
│  ├── 모바일에서 호버 불가                                              │
│  ├── 실수로 클릭 가능성                                                │
│  └── 터치 디바이스 미지원                                              │
│                                                                         │
│  적합도: ⭐⭐⭐ (데스크톱 전용이면 OK)                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 4. 권장 설계: 패턴 B (더보기 메뉴)

### 4.1 UI 구조

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     최종 UI 설계                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  문서 카드 레이아웃:                                                    │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  ┌────┐                                                          │  │
│  │  │ 📄 │  251128_중3 정규반_문제지                         [⋮]   │  │
│  │  └────┘  16페이지 • 라벨링 대기                                  │  │
│  │          ○ ────────────── 0%                                     │  │
│  │                                                   [시작하기 →]   │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  더보기 메뉴 (클릭 시):                                                 │
│  ┌──────────────────┐                                                   │
│  │  📝 문서 설정    │ ← 이름, 페이지 오프셋 등                         │
│  │  📤 전체 내보내기 │ ← 모든 문제 내보내기                            │
│  │  ─────────────── │                                                   │
│  │  🗑️ 삭제         │ ← 빨간색 텍스트                                  │
│  └──────────────────┘                                                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.2 삭제 확인 모달 (중요!)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     삭제 확인 모달                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                                                                  │  │
│  │            ⚠️                                                    │  │
│  │                                                                  │  │
│  │           문서를 삭제할까요?                                     │  │
│  │                                                                  │  │
│  │    "251128_중3 정규반_문제지"                                    │  │
│  │                                                                  │  │
│  │    ┌────────────────────────────────────────────────────────┐   │  │
│  │    │  • 16개 페이지 이미지                                   │   │  │
│  │    │  • 라벨링 데이터 (복구 불가)                            │   │  │
│  │    │  • 내보낸 문제 이미지                                   │   │  │
│  │    └────────────────────────────────────────────────────────┘   │  │
│  │                                                                  │  │
│  │    삭제된 문서는 복구할 수 없습니다.                            │  │
│  │                                                                  │  │
│  │    ┌────────────┐    ┌─────────────────────┐                    │  │
│  │    │    취소    │    │      🗑️ 삭제       │                    │  │
│  │    └────────────┘    └─────────────────────┘                    │  │
│  │      (회색)             (빨간색)                                 │  │
│  │                                                                  │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.3 상태별 삭제 정책

| 상태 | 삭제 위험도 | 확인 수준 | 설명 |
|------|-------------|-----------|------|
| `processing` | 🟡 Low | 1단계 (메뉴만) | 아직 라벨링 전, 복구 쉬움 |
| `ready` | 🟡 Low | 1단계 (메뉴만) | 라벨링 전, 다시 업로드 가능 |
| `labeling` | 🔴 High | 2단계 (모달) | 라벨링 작업 손실 위험 |
| `completed` | 🔴 Critical | 2단계 (모달 + 경고) | 완료된 작업 손실 |

---

## 5. 구현 계획

### 5.1 컴포넌트 구조

```typescript
// 새로 추가할 컴포넌트
frontend/src/components/
├── DocumentMenu.tsx           // 더보기 메뉴 (⋮)
└── DeleteConfirmModal.tsx     // 삭제 확인 모달

// 수정할 파일
frontend/src/pages/
└── RegistrationPage.tsx       // DocumentCard에 메뉴 추가
```

### 5.2 코드 흐름

```
사용자 클릭 ⋮ → DocumentMenu 열림
       │
       ▼
사용자 클릭 "삭제" → 상태 확인
       │
       ├── ready/processing → Toast 확인 ("삭제할까요?")
       │                           │
       │                           ├── 취소 → 닫기
       │                           └── 확인 → deleteDocument() → 목록 갱신
       │
       └── labeling/completed → DeleteConfirmModal
                                    │
                                    ├── 취소 → 닫기
                                    └── 삭제 → deleteDocument() → 목록 갱신
```

### 5.3 구현 우선순위

```
Phase 1 (즉시): 기본 삭제 기능
├── DocumentCard에 ⋮ 메뉴 버튼 추가
├── Popover 메뉴 (삭제 옵션)
└── 토스트로 삭제 성공/실패 피드백

Phase 2 (다음): 안전 장치
├── DeleteConfirmModal 컴포넌트
├── 상태별 확인 수준 분기
└── 삭제할 데이터 요약 표시

Phase 3 (선택): 고급 기능
├── 휴지통 (Soft Delete)
├── 30일 후 자동 영구 삭제
└── 휴지통에서 복구 기능
```

---

## 6. 코드 구현 가이드

### 6.1 DocumentCard 수정

```typescript
// RegistrationPage.tsx 내 DocumentCard 컴포넌트 수정

import { Menu } from '@headlessui/react';
import { MoreVertical, Settings, Download, Trash2 } from 'lucide-react';

function DocumentCard({ document, onContinue, onDelete }: DocumentCardProps) {
  return (
    <Card className="p-4">
      <div className="flex items-start gap-4">
        {/* 기존 아이콘, 내용 */}

        {/* 더보기 메뉴 */}
        <Menu as="div" className="relative">
          <Menu.Button className="p-2 rounded-lg hover:bg-grey-100">
            <MoreVertical className="w-5 h-5 text-grey-400" />
          </Menu.Button>

          <Menu.Items className="absolute right-0 mt-1 w-48 bg-white rounded-xl shadow-lg border">
            <Menu.Item>
              {({ active }) => (
                <button className={cn(
                  'flex items-center gap-3 w-full px-4 py-3 text-sm',
                  active && 'bg-grey-50'
                )}>
                  <Settings className="w-4 h-4" />
                  문서 설정
                </button>
              )}
            </Menu.Item>

            <div className="border-t border-grey-100" />

            <Menu.Item>
              {({ active }) => (
                <button
                  onClick={() => onDelete(document.id)}
                  className={cn(
                    'flex items-center gap-3 w-full px-4 py-3 text-sm text-error',
                    active && 'bg-red-50'
                  )}
                >
                  <Trash2 className="w-4 h-4" />
                  삭제
                </button>
              )}
            </Menu.Item>
          </Menu.Items>
        </Menu>

        {/* 기존 시작하기 버튼 */}
      </div>
    </Card>
  );
}
```

### 6.2 삭제 핸들러

```typescript
// RegistrationPage.tsx

const deleteMutation = useDeleteDocument();
const [deleteTarget, setDeleteTarget] = useState<DocumentItem | null>(null);

const handleDeleteClick = (document: DocumentItem) => {
  // 라벨링 진행 중이면 모달로 확인
  if (document.status === 'labeling' || document.status === 'completed') {
    setDeleteTarget(document);
  } else {
    // 바로 삭제 (토스트로 확인)
    if (confirm(`"${document.name}" 문서를 삭제할까요?`)) {
      deleteMutation.mutate(document.id);
    }
  }
};

const handleConfirmDelete = () => {
  if (deleteTarget) {
    deleteMutation.mutate(deleteTarget.id, {
      onSuccess: () => {
        toast.success('문서가 삭제되었습니다');
        setDeleteTarget(null);
      },
      onError: () => {
        toast.error('삭제에 실패했습니다');
      }
    });
  }
};
```

---

## 7. 토스트 메시지 설계

### 7.1 성공 메시지

```
┌────────────────────────────────────────┐
│  ✓ 문서가 삭제되었습니다              │
└────────────────────────────────────────┘
```

### 7.2 에러 메시지

```
┌────────────────────────────────────────┐
│  ✗ 삭제에 실패했습니다. 다시 시도해주세요  │
└────────────────────────────────────────┘
```

### 7.3 되돌리기 (선택적 - Phase 3)

```
┌────────────────────────────────────────────────────────┐
│  ✓ 문서가 삭제되었습니다                [되돌리기]    │
└────────────────────────────────────────────────────────┘
```

---

## 8. 결론 및 권장사항

### 8.1 즉시 구현 (Phase 1)

| 항목 | 설명 |
|------|------|
| **더보기 메뉴** | DocumentCard 우상단에 ⋮ 버튼 |
| **삭제 옵션** | 메뉴 내 빨간색 "삭제" 항목 |
| **토스트 피드백** | 성공/실패 알림 |

### 8.2 다음 단계 (Phase 2)

| 항목 | 설명 |
|------|------|
| **확인 모달** | 라벨링 진행/완료 문서에 대해 |
| **데이터 요약** | 삭제될 내용 표시 |

### 8.3 장기 개선 (Phase 3)

| 항목 | 설명 |
|------|------|
| **휴지통** | Soft Delete 구현 |
| **되돌리기** | 토스트에서 즉시 복구 |
| **자동 정리** | 30일 후 영구 삭제 |

---

## 9. 예상 작업량

| Phase | 작업 | 예상 시간 |
|-------|------|-----------|
| Phase 1 | 더보기 메뉴 + 기본 삭제 | 30분 |
| Phase 2 | 확인 모달 + 상태별 분기 | 1시간 |
| Phase 3 | 휴지통 시스템 | 4시간 |

---

*"진행해줘"라고 하시면 Phase 1 (더보기 메뉴 + 기본 삭제)부터 구현합니다.*

---

*작성: Claude Code (Phase 21.6+)*
